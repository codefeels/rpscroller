import{r as he,R as Nt,a as S,u as pe,b as Ee,m as me,j as U,B as Re}from"./index-C120Daol.js";import{L as Bt,E as Se,C as ge}from"./LoadingSpinner-lCXZmRWm.js";import"./Link-DJoavA-F.js";import"./formatDistanceToNowStrict-BYAa6EDh.js";import"./en-US-haJ8O9Oa.js";var gt={exports:{}},vt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jt;function ve(){if(Jt)return vt;Jt=1;var t=he();function e(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,u=t.useEffect,s=t.useLayoutEffect,i=t.useDebugValue;function m(c,h){var o=h(),_=r({inst:{value:o,getSnapshot:h}}),p=_[0].inst,k=_[1];return s(function(){p.value=o,p.getSnapshot=h,l(p)&&k({inst:p})},[c,o,h]),u(function(){return l(p)&&k({inst:p}),c(function(){l(p)&&k({inst:p})})},[c]),i(o),o}function l(c){var h=c.getSnapshot;c=c.value;try{var o=h();return!n(c,o)}catch{return!0}}function O(c,h){return h()}var y=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?O:m;return vt.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:y,vt}var Kt;function we(){return Kt||(Kt=1,gt.exports=ve()),gt.exports}var ee=we();const ne=0,se=1,re=2,Gt=3;var Yt=Object.prototype.hasOwnProperty;function bt(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&bt(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(Yt.call(t,n)&&++r&&!Yt.call(e,n)||!(n in e)||!bt(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}const K=new WeakMap,Z=()=>{},D=Z(),At=Object,f=t=>t===D,H=t=>typeof t=="function",tt=(t,e)=>({...t,...e}),ie=t=>H(t.then),wt={},dt={},Mt="undefined",lt=typeof window!=Mt,Lt=typeof document!=Mt,ye=lt&&"Deno"in window,_e=()=>lt&&typeof window.requestAnimationFrame!=Mt,Q=(t,e)=>{const n=K.get(t);return[()=>!f(e)&&t.get(e)||wt,r=>{if(!f(e)){const u=t.get(e);e in dt||(dt[e]=u),n[5](e,tt(u,r),u||wt)}},n[6],()=>!f(e)&&e in dt?dt[e]:!f(e)&&t.get(e)||wt]};let xt=!0;const Oe=()=>xt,[It,Vt]=lt&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[Z,Z],Ce=()=>{const t=Lt&&document.visibilityState;return f(t)||t!=="hidden"},De=t=>(Lt&&document.addEventListener("visibilitychange",t),It("focus",t),()=>{Lt&&document.removeEventListener("visibilitychange",t),Vt("focus",t)}),Te=t=>{const e=()=>{xt=!0,t()},n=()=>{xt=!1};return It("online",e),It("offline",n),()=>{Vt("online",e),Vt("offline",n)}},be={isOnline:Oe,isVisible:Ce},Ae={initFocus:De,initReconnect:Te},Xt=!Nt.useId,ct=!lt||ye,Le=t=>_e()?window.requestAnimationFrame(t):setTimeout(t,1),Et=ct?S.useEffect:S.useLayoutEffect,yt=typeof navigator<"u"&&navigator.connection,Qt=!ct&&yt&&(["slow-2g","2g"].includes(yt.effectiveType)||yt.saveData),ht=new WeakMap,_t=(t,e)=>At.prototype.toString.call(t)===`[object ${e}]`;let xe=0;const jt=t=>{const e=typeof t,n=_t(t,"Date"),r=_t(t,"RegExp"),u=_t(t,"Object");let s,i;if(At(t)===t&&!n&&!r){if(s=ht.get(t),s)return s;if(s=++xe+"~",ht.set(t,s),Array.isArray(t)){for(s="@",i=0;i<t.length;i++)s+=jt(t[i])+",";ht.set(t,s)}if(u){s="#";const m=At.keys(t).sort();for(;!f(i=m.pop());)f(t[i])||(s+=i+":"+jt(t[i])+",");ht.set(t,s)}}else s=n?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},ut=t=>{if(H(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?jt(t):"",[t,e]};let Ie=0;const Pt=()=>++Ie;async function oe(...t){const[e,n,r,u]=t,s=tt({populateCache:!0,throwOnError:!0},typeof u=="boolean"?{revalidate:u}:u||{});let i=s.populateCache;const m=s.rollbackOnError;let l=s.optimisticData;const O=h=>typeof m=="function"?m(h):m!==!1,y=s.throwOnError;if(H(n)){const h=n,o=[],_=e.keys();for(const p of _)!/^\$(inf|sub)\$/.test(p)&&h(e.get(p)._k)&&o.push(p);return Promise.all(o.map(c))}return c(n);async function c(h){const[o]=ut(h);if(!o)return;const[_,p]=Q(e,o),[k,a,$,q]=K.get(e),N=()=>{const I=k[o];return(H(s.revalidate)?s.revalidate(_().data,h):s.revalidate!==!1)&&(delete $[o],delete q[o],I&&I[0])?I[0](re).then(()=>_().data):_().data};if(t.length<3)return N();let R=r,E;const L=Pt();a[o]=[L,0];const d=!f(l),F=_(),g=F.data,x=F._c,z=f(x)?g:x;if(d&&(l=H(l)?l(z,g):l,p({data:l,_c:z})),H(R))try{R=R(z)}catch(I){E=I}if(R&&ie(R))if(R=await R.catch(I=>{E=I}),L!==a[o][0]){if(E)throw E;return R}else E&&d&&O(E)&&(i=!0,p({data:z,_c:D}));if(i&&!E)if(H(i)){const I=i(R,z);p({data:I,error:D,_c:D})}else p({data:R,error:D,_c:D});if(a[o][1]=Pt(),Promise.resolve(N()).then(()=>{p({_c:D})}),E){if(y)throw E;return}return R}}const Zt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},Ve=(t,e)=>{if(!K.has(t)){const n=tt(Ae,e),r={},u=oe.bind(D,t);let s=Z;const i={},m=(y,c)=>{const h=i[y]||[];return i[y]=h,h.push(c),()=>h.splice(h.indexOf(c),1)},l=(y,c,h)=>{t.set(y,c);const o=i[y];if(o)for(const _ of o)_(c,h)},O=()=>{if(!K.has(t)&&(K.set(t,[r,{},{},{},u,l,m]),!ct)){const y=n.initFocus(setTimeout.bind(D,Zt.bind(D,r,ne))),c=n.initReconnect(setTimeout.bind(D,Zt.bind(D,r,se)));s=()=>{y&&y(),c&&c(),K.delete(t)}}};return O(),[t,u,O,s]}return[t,K.get(t)[4]]},je=(t,e,n,r,u)=>{const s=n.errorRetryCount,i=u.retryCount,m=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!f(s)&&i>s||setTimeout(r,m,u)},Pe=bt,[Wt,$e]=Ve(new Map),Fe=tt({onLoadingSlow:Z,onSuccess:Z,onError:Z,onErrorRetry:je,onDiscarded:Z,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Qt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Qt?5e3:3e3,compare:Pe,isPaused:()=>!1,cache:Wt,mutate:$e,fallback:{}},be),Ne=(t,e)=>{const n=tt(t,e);if(e){const{use:r,fallback:u}=t,{use:s,fallback:i}=e;r&&s&&(n.use=r.concat(s)),u&&i&&(n.fallback=tt(u,i))}return n},Me=S.createContext({}),ae="$inf$",ce=lt&&window.__SWR_DEVTOOLS_USE__,We=ce?window.__SWR_DEVTOOLS_USE__:[],qe=()=>{ce&&(window.__SWR_DEVTOOLS_REACT__=Nt)},ue=t=>H(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],ze=()=>tt(Fe,S.useContext(Me)),Ue=t=>(e,n,r)=>t(e,n&&((...s)=>{const[i]=ut(e),[,,,m]=K.get(Wt);if(i.startsWith(ae))return n(...s);const l=m[i];return f(l)?n(...s):(delete m[i],l)}),r),He=We.concat(Ue),ke=t=>function(...n){const r=ze(),[u,s,i]=ue(n),m=Ne(r,i);let l=t;const{use:O}=m,y=(O||[]).concat(He);for(let c=y.length;c--;)l=y[c](l);return l(u,s||m.fetcher||null,m)},Be=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const u=r.indexOf(n);u>=0&&(r[u]=r[r.length-1],r.pop())}},Je=(t,e)=>(...n)=>{const[r,u,s]=ue(n),i=(s.use||[]).concat(e);return t(r,u,{...s,use:i})};qe();const Ot=Nt.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),Ct={dedupe:!0},Ke=(t,e,n)=>{const{cache:r,compare:u,suspense:s,fallbackData:i,revalidateOnMount:m,revalidateIfStale:l,refreshInterval:O,refreshWhenHidden:y,refreshWhenOffline:c,keepPreviousData:h}=n,[o,_,p,k]=K.get(r),[a,$]=ut(t),q=S.useRef(!1),N=S.useRef(!1),R=S.useRef(a),E=S.useRef(e),L=S.useRef(n),d=()=>L.current,F=()=>d().isVisible()&&d().isOnline(),[g,x,z,I]=Q(r,a),j=S.useRef({}).current,B=f(i)?f(n.fallback)?D:n.fallback[a]:i,et=(v,w)=>{for(const V in j){const C=V;if(C==="data"){if(!u(v[C],w[C])&&(!f(v[C])||!u(ot,w[C])))return!1}else if(w[C]!==v[C])return!1}return!0},T=S.useMemo(()=>{const v=!a||!e?!1:f(m)?d().isPaused()||s?!1:l!==!1:m,w=P=>{const G=tt(P);return delete G._k,v?{isValidating:!0,isLoading:!0,...G}:G},V=g(),C=I(),J=w(V),it=V===C?J:w(C);let A=J;return[()=>{const P=w(g());return et(P,A)?(A.data=P.data,A.isLoading=P.isLoading,A.isValidating=P.isValidating,A.error=P.error,A):(A=P,P)},()=>it]},[r,a]),M=ee.useSyncExternalStore(S.useCallback(v=>z(a,(w,V)=>{et(V,w)||v()}),[r,a]),T[0],T[1]),nt=!q.current,mt=o[a]&&o[a].length>0,X=M.data,b=f(X)?B&&ie(B)?Ot(B):B:X,st=M.error,rt=S.useRef(b),ot=h?f(X)?f(rt.current)?b:rt.current:X:b,ft=mt&&!f(st)?!1:nt&&!f(m)?m:d().isPaused()?!1:s?f(b)?!1:l:f(b)||l,qt=!!(a&&e&&nt&&ft),le=f(M.isValidating)?qt:M.isValidating,fe=f(M.isLoading)?qt:M.isLoading,at=S.useCallback(async v=>{const w=E.current;if(!a||!w||N.current||d().isPaused())return!1;let V,C,J=!0;const it=v||{},A=!p[a]||!it.dedupe,P=()=>Xt?!N.current&&a===R.current&&q.current:a===R.current,G={isValidating:!1,isLoading:!1},Ut=()=>{x(G)},Ht=()=>{const W=p[a];W&&W[1]===C&&delete p[a]},kt={isValidating:!0};f(g().data)&&(kt.isLoading=!0);try{if(A&&(x(kt),n.loadingTimeout&&f(g().data)&&setTimeout(()=>{J&&P()&&d().onLoadingSlow(a,n)},n.loadingTimeout),p[a]=[w($),Pt()]),[V,C]=p[a],V=await V,A&&setTimeout(Ht,n.dedupingInterval),!p[a]||p[a][1]!==C)return A&&P()&&d().onDiscarded(a),!1;G.error=D;const W=_[a];if(!f(W)&&(C<=W[0]||C<=W[1]||W[1]===0))return Ut(),A&&P()&&d().onDiscarded(a),!1;const Y=g().data;G.data=u(Y,V)?Y:V,A&&P()&&d().onSuccess(V,a,n)}catch(W){Ht();const Y=d(),{shouldRetryOnError:Rt}=Y;Y.isPaused()||(G.error=W,A&&P()&&(Y.onError(W,a,Y),(Rt===!0||H(Rt)&&Rt(W))&&(!d().revalidateOnFocus||!d().revalidateOnReconnect||F())&&Y.onErrorRetry(W,a,Y,de=>{const St=o[a];St&&St[0]&&St[0](Gt,de)},{retryCount:(it.retryCount||0)+1,dedupe:!0})))}return J=!1,Ut(),!0},[a,r]),zt=S.useCallback((...v)=>oe(r,R.current,...v),[]);if(Et(()=>{E.current=e,L.current=n,f(X)||(rt.current=X)}),Et(()=>{if(!a)return;const v=at.bind(D,Ct);let w=0;const C=Be(a,o,(J,it={})=>{if(J==ne){const A=Date.now();d().revalidateOnFocus&&A>w&&F()&&(w=A+d().focusThrottleInterval,v())}else if(J==se)d().revalidateOnReconnect&&F()&&v();else{if(J==re)return at();if(J==Gt)return at(it)}});return N.current=!1,R.current=a,q.current=!0,x({_k:$}),ft&&(f(b)||ct?v():Le(v)),()=>{N.current=!0,C()}},[a]),Et(()=>{let v;function w(){const C=H(O)?O(g().data):O;C&&v!==-1&&(v=setTimeout(V,C))}function V(){!g().error&&(y||d().isVisible())&&(c||d().isOnline())?at(Ct).then(w):w()}return w(),()=>{v&&(clearTimeout(v),v=-1)}},[O,y,c,a]),S.useDebugValue(ot),s&&f(b)&&a){if(!Xt&&ct)throw new Error("Fallback data is required when using Suspense in SSR.");E.current=e,L.current=n,N.current=!1;const v=k[a];if(!f(v)){const w=zt(v);Ot(w)}if(f(st)){const w=at(Ct);f(ot)||(w.status="fulfilled",w.value=!0),Ot(w)}else throw st}return{mutate:zt,get data(){return j.data=!0,ot},get error(){return j.error=!0,st},get isValidating(){return j.isValidating=!0,le},get isLoading(){return j.isLoading=!0,fe}}},Ge=ke(Ke),Ye=()=>{},Xe=Ye(),$t=Object,te=t=>t===Xe,Qe=t=>typeof t=="function",pt=new WeakMap,Dt=(t,e)=>$t.prototype.toString.call(t)===`[object ${e}]`;let Ze=0;const Ft=t=>{const e=typeof t,n=Dt(t,"Date"),r=Dt(t,"RegExp"),u=Dt(t,"Object");let s,i;if($t(t)===t&&!n&&!r){if(s=pt.get(t),s)return s;if(s=++Ze+"~",pt.set(t,s),Array.isArray(t)){for(s="@",i=0;i<t.length;i++)s+=Ft(t[i])+",";pt.set(t,s)}if(u){s="#";const m=$t.keys(t).sort();for(;!te(i=m.pop());)te(t[i])||(s+=i+":"+Ft(t[i])+",");pt.set(t,s)}}else s=n?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},tn=t=>{if(Qe(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Ft(t):"",[t,e]},en=t=>tn(t?t(0,null):null)[0],Tt=Promise.resolve(),nn=t=>(e,n,r)=>{const u=S.useRef(!1),{cache:s,initialSize:i=1,revalidateAll:m=!1,persistSize:l=!1,revalidateFirstPage:O=!0,revalidateOnMount:y=!1,parallel:c=!1}=r,[,,,h]=K.get(Wt);let o;try{o=en(e),o&&(o=ae+o)}catch{}const[_,p,k]=Q(s,o),a=S.useCallback(()=>f(_()._l)?i:_()._l,[s,o,i]);ee.useSyncExternalStore(S.useCallback(d=>o?k(o,()=>{d()}):()=>{},[s,o]),a,a);const $=S.useCallback(()=>{const d=_()._l;return f(d)?i:d},[o,i]),q=S.useRef($());Et(()=>{if(!u.current){u.current=!0;return}o&&p({_l:l?q.current:$()})},[o,s]);const N=y&&!u.current,R=t(o,async d=>{const F=_()._i,g=_()._r;p({_r:D});const x=[],z=$(),[I]=Q(s,d),j=I().data,B=[];let et=null;for(let T=0;T<z;++T){const[M,nt]=ut(e(T,c?null:et));if(!M)break;const[mt,X]=Q(s,M);let b=mt().data;const st=m||F||f(b)||O&&!T&&!f(j)||N||j&&!f(j[T])&&!r.compare(j[T],b);if(n&&(typeof g=="function"?g(b,nt):st)){const rt=async()=>{if(!(M in h))b=await n(nt);else{const ft=h[M];delete h[M],b=await ft}X({data:b,_k:nt}),x[T]=b};c?B.push(rt):await rt()}else x[T]=b;c||(et=b)}return c&&await Promise.all(B.map(T=>T())),p({_i:D}),x},r),E=S.useCallback(function(d,F){const g=typeof F=="boolean"?{revalidate:F}:F||{},x=g.revalidate!==!1;return o?(x&&(f(d)?p({_i:!0,_r:g.revalidate}):p({_i:!1,_r:g.revalidate})),arguments.length?R.mutate(d,{...g,revalidate:x}):R.mutate()):Tt},[o,s]),L=S.useCallback(d=>{if(!o)return Tt;const[,F]=Q(s,o);let g;if(H(d)?g=d($()):typeof d=="number"&&(g=d),typeof g!="number")return Tt;F({_l:g}),q.current=g;const x=[],[z]=Q(s,o);let I=null;for(let j=0;j<g;++j){const[B]=ut(e(j,I)),[et]=Q(s,B),T=B?et().data:D;if(f(T))return E(z().data);x.push(T),I=T}return E(x)},[o,s,E,$]);return{size:$(),setSize:L,mutate:E,get data(){return R.data},get error(){return R.error},get isValidating(){return R.isValidating},get isLoading(){return R.isLoading}}},sn=Je(Ge,nn),rn=t=>(e,n)=>n&&!n.after?null:e===0?`${t}${t.includes("?")?"&":"?"}limit=25`:`${t}${t.includes("?")?"&":"?"}after=${n==null?void 0:n.after}&limit=25`;function dn(){var q,N,R;const t=pe(),{mode:e,val:n}=t,{isIntersecting:r,ref:u}=Ee({threshold:.9});S.useEffect(()=>{function E(L){L.state&&t.setVal(L.state.val)}return window.addEventListener("popstate",E),()=>{window.removeEventListener("popstate",E)}},[t]);const s=S.useRef(!1),i=(q=me.get(e))==null?void 0:q.url,m=`https://www.reddit.com/${n.startsWith("/")?n.slice(1):n}${i??""}`,{data:l,size:O,setSize:y,error:c,isValidating:h,isLoading:o}=sn(rn(m),async E=>{const L=await fetch(E);if(!L.ok)throw new Error(`HTTP ${L.status} fetching ${E} ${await L.text()}`);return(await L.json()).data}),_=l==null?void 0:l.flatMap(E=>E.children).map(E=>E.data),p=o||O>0&&(l==null?void 0:l[O-1])===void 0,a=(((N=l==null?void 0:l[0])==null?void 0:N.children.length)??0)===0||(((R=l==null?void 0:l.at(-1))==null?void 0:R.children.length)??0)<25,$=h&&l&&l.length===O;return S.useEffect(()=>{r&&!s.current&&!o&&!$&&!a&&(s.current=!0,setTimeout(()=>{y(O+1).then(()=>{s.current=!1}).catch(E=>{console.error(E)})},400))},[r,y,O,a,$,o]),U.jsx("div",{children:o?U.jsx("div",{className:"flex justify-center",children:U.jsx(Bt,{})}):c?U.jsx(Se,{error:c}):_?U.jsxs(U.Fragment,{children:[U.jsx(ge,{posts:_}),U.jsx("div",{ref:u,style:{height:400},className:"flex justify-center mt-10",children:p?U.jsx(Bt,{}):a?"End of feed!":U.jsxs("div",{children:["Scroll all the way down or"," ",U.jsx(Re,{onClick:()=>{y(O+1).then(()=>{s.current=!1})},children:"Click here"})," ","to load more"]})})]}):null})}export{dn as default};
//# sourceMappingURL=RedditPostFeed-cn9qnpT9.js.map
