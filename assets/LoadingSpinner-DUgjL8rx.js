const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./AddToFeedDialog-BzjvCmBa.js","./index-BB_gcNWQ.js","./index-4Dlsw4Xn.css","./BaseDialog-DgxF3BXf.js","./RedGifsCard-DvI4xFKJ.js","./GalleryCard-Bvnv_tNy.js","./Sidebar-C93TYx6-.js","./Link-DzHJFf2h.js","./formatDistanceToNowStrict-B7etE4jS.js","./en-US-DK8Z8mF7.js"])))=>i.map(i=>d[i]);
import{G as ie,j as t,u as w,a as oe,p,r as h,q as z,L as F,s as b,t as ae,v as P,M as de,_ as T,w as ce,B as le}from"./index-BB_gcNWQ.js";import{g as G,h as V}from"./Sidebar-C93TYx6-.js";import{d as D,a as $}from"./BaseDialog-DgxF3BXf.js";import{L as v}from"./Link-DzHJFf2h.js";import{f as ue}from"./formatDistanceToNowStrict-B7etE4jS.js";function he(e){return ie({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 14h4v7a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-7h4a1.001 1.001 0 0 0 .781-1.625l-8-10c-.381-.475-1.181-.475-1.562 0l-8 10A1.001 1.001 0 0 0 4 14z"},child:[]}]})(e)}function fe({error:e}){return t.jsxs("div",{className:"text-red-600 m-20",children:[t.jsx("div",{children:`${e}`}),t.jsxs("div",{children:[`${e}`=="TypeError: NetworkError when attempting to fetch resource."?"If you are on firefox then you can disable 'Enhanced Tracking Protection' (at your own risk) to fix this error":""," "]})]})}const B=(e,n)=>n.some(s=>e instanceof s);let H,K;function me(){return H||(H=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xe(){return K||(K=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const N=new WeakMap,C=new WeakMap,y=new WeakMap;function je(e){const n=new Promise((s,r)=>{const o=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{s(x(e.result)),o()},i=()=>{r(e.error),o()};e.addEventListener("success",a),e.addEventListener("error",i)});return y.set(n,e),n}function ge(e){if(N.has(e))return;const n=new Promise((s,r)=>{const o=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{s(),o()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});N.set(e,n)}let S={get(e,n,s){if(e instanceof IDBTransaction){if(n==="done")return N.get(e);if(n==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return x(e[n])},set(e,n,s){return e[n]=s,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function X(e){S=e(S)}function be(e){return xe().includes(e)?function(...n){return e.apply(k(this),n),x(this.request)}:function(...n){return x(e.apply(k(this),n))}}function ve(e){return typeof e=="function"?be(e):(e instanceof IDBTransaction&&ge(e),B(e,me())?new Proxy(e,S):e)}function x(e){if(e instanceof IDBRequest)return je(e);if(C.has(e))return C.get(e);const n=ve(e);return n!==e&&(C.set(e,n),y.set(n,e)),n}const k=e=>y.get(e);function we(e,n,{blocked:s,upgrade:r,blocking:o,terminated:a}={}){const i=indexedDB.open(e,n),c=x(i);return r&&i.addEventListener("upgradeneeded",d=>{r(x(i.result),d.oldVersion,d.newVersion,x(i.transaction),d)}),s&&i.addEventListener("blocked",d=>s(d.oldVersion,d.newVersion,d)),c.then(d=>{a&&d.addEventListener("close",()=>a()),o&&d.addEventListener("versionchange",l=>o(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}const ye=["get","getKey","getAll","getAllKeys","count"],pe=["put","add","delete","clear"],I=new Map;function U(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(I.get(n))return I.get(n);const s=n.replace(/FromIndex$/,""),r=n!==s,o=pe.includes(s);if(!(s in(r?IDBIndex:IDBObjectStore).prototype)||!(o||ye.includes(s)))return;const a=async function(i,...c){const d=this.transaction(i,o?"readwrite":"readonly");let l=d.store;return r&&(l=l.index(c.shift())),(await Promise.all([l[s](...c),o&&d.done]))[0]};return I.set(n,a),a}X(e=>({...e,get:(n,s,r)=>U(n,s)||e.get(n,s,r),has:(n,s)=>!!U(n,s)||e.has(n,s)}));const Fe=["continue","continuePrimaryKey","advance"],J={},E=new WeakMap,Y=new WeakMap,Pe={get(e,n){if(!Fe.includes(n))return e[n];let s=J[n];return s||(s=J[n]=function(...r){E.set(this,Y.get(this)[n](...r))}),s}};async function*De(...e){let n=this;if(n instanceof IDBCursor||(n=await n.openCursor(...e)),!n)return;n=n;const s=new Proxy(n,Pe);for(Y.set(s,n),y.set(s,k(n));n;)yield s,n=await(E.get(s)||n.continue()),E.delete(s)}function Q(e,n){return n===Symbol.asyncIterator&&B(e,[IDBIndex,IDBObjectStore,IDBCursor])||n==="iterate"&&B(e,[IDBIndex,IDBObjectStore])}X(e=>({...e,get(n,s,r){return Q(n,s)?De:e.get(n,s,r)},has(n,s){return Q(n,s)||e.has(n,s)}}));const Z=we("test",2,{upgrade(e){e.createObjectStore("savedPosts")}}),Ce=h.lazy(()=>T(()=>import("./AddToFeedDialog-BzjvCmBa.js"),__vite__mapDeps([0,1,2,3]),import.meta.url));async function Ie(e){await(await Z).put("savedPosts",e,e.id)}async function Be(e){await(await Z).delete("savedPosts",e.id)}function Ne({post:e}){var W;const n=w(),{author:s,subreddit:r,subreddit_name_prefixed:o,crosspost_parent_list:a}=e,{defaultPage:i,favorites:c,blocked:d}=n,l=oe(i),j=`/u/${s}`,M=p(`/user/${s}`,c),f=((W=a==null?void 0:a[0])==null?void 0:W.subreddit_name_prefixed)??"",u=o,q=p(f,c),ee=p(u,c),[ne,_]=h.useState(!1),[L,g]=h.useState(),[te,A]=h.useState(!1),[se,re]=h.useState(""),O=m=>{re(m),A(!0)},R=z(j)===z(o);return t.jsxs("div",{className:"inline",children:[t.jsx(F,{to:j,children:t.jsxs(b,{children:[t.jsx(D,{className:"inline"})," Browse ",j]})}),f?t.jsx(F,{to:f,children:t.jsxs(b,{children:[t.jsx(D,{className:"inline"})," Browse ",f]})}):null,R?null:t.jsx(F,{to:u,children:t.jsxs(b,{children:[t.jsx(D,{className:"inline"})," Browse ",u]})}),t.jsxs("div",{className:"dropdown",children:[L?t.jsx(fe,{error:L}):null,t.jsxs(b,{className:"inline",children:["More options ",t.jsx(ae,{})]}),t.jsxs("ul",{tabIndex:0,className:"dropdown-content menu bg-base-300 z-1 w-80 shadow-sm",children:[t.jsxs("li",{className:"menu-title",children:["User (",j,")"]}),!M&&t.jsx("li",{children:t.jsxs("button",{onClick:()=>n.addFavorite(`/user/${s}`),children:[t.jsx(P,{className:"inline"})," Favorite user"]})}),!M&&!d.includes(s)&&t.jsx("li",{children:t.jsxs("button",{onClick:()=>n.setBlocked(s),children:[t.jsx(de,{className:"inline"})," Block user"]})}),t.jsx("li",{children:t.jsxs("button",{onClick:()=>O(`u_${s}`),children:[t.jsx($,{className:"inline"})," Add user to feed"]})}),t.jsx("li",{children:t.jsxs("button",{onClick:()=>n.setDefaultPage(j),children:[t.jsx(G,{className:"inline"})," Set user as home"]})}),R?null:t.jsxs(t.Fragment,{children:[t.jsxs("li",{className:"menu-title",children:["Subreddit ",f]}),f&&t.jsx(t.Fragment,{children:!q&&t.jsx("li",{children:t.jsxs("button",{onClick:()=>n.addFavorite(f),children:[t.jsx(P,{className:"inline"})," Favorite"," ",f]})})}),u!==j&&t.jsxs(t.Fragment,{children:[!ee&&t.jsx("li",{children:t.jsxs("button",{onClick:()=>n.addFavorite(u),children:[t.jsx(P,{className:"inline"})," Favorite"," ",u]})}),t.jsx("li",{children:t.jsxs("button",{onClick:()=>O(r),children:[t.jsx($,{className:"inline"})," Add ",u," to feed"]})}),t.jsx("li",{children:t.jsxs("button",{onClick:()=>n.setDefaultPage(u),children:[t.jsx(G,{className:"inline"})," Set ",u," as home"]})})]})]}),t.jsx("li",{children:l==="savedposts"?t.jsxs("button",{onClick:()=>{(async()=>{try{g(void 0),await Be(e),n.forceRerender()}catch(m){g(m),console.error(m)}})()},children:[t.jsx(V,{className:"inline"})," Remove from saved"]}):t.jsxs("button",{onClick:()=>{(async()=>{try{g(void 0),await Ie(e)}catch(m){g(m),console.error(m)}})(),_(!0),setTimeout(()=>{_(!1)},400)},children:[t.jsx(V,{className:"inline"})," ",ne?"Saved!":"Save post"]})})]}),te?t.jsx(h.Suspense,{fallback:null,children:t.jsx(Ce,{subreddit:se,onClose:()=>{A(!1)}})}):null]})]})}function Se({post:e}){return t.jsx("div",{children:t.jsx(Ne,{post:e})})}function ke({post:e}){const{hideButtons:n}=w(),{author:s,subreddit_name_prefixed:r,title:o,permalink:a,url:i}=e;return t.jsxs("div",{children:[t.jsxs("h4",{className:"inline",children:[ce(o)," (",ue(new Date(e.created*1e3),{addSuffix:!0}),") [",e.score," ",t.jsx(he,{className:"inline"}),"]"]})," ","(",t.jsx(v,{href:`https://reddit.com/u/${s}`,target:"_blank",rel:"noreferrer",children:"user"}),") (",t.jsx(v,{href:i,target:"_blank",rel:"noreferrer",children:"url"}),") (",t.jsx(v,{href:`https://reddit.com/${r}`,target:"_blank",rel:"noreferrer",children:"subreddit"}),") (",t.jsx(v,{href:`https://reddit.com${a}`,target:"_blank",rel:"noreferrer",children:"comments"}),")",n?null:t.jsx(Se,{post:e})]})}function Ee({title:e,url:n}){const[s,r]=h.useState(!1);return t.jsx("img",{alt:e,loading:"lazy",onClick:()=>{r(!s)},className:s?"m-auto":"w-full max-h-[80vh] object-contain",src:n})}const Te=h.lazy(()=>T(()=>import("./RedGifsCard-DvI4xFKJ.js"),__vite__mapDeps([4,1,2]),import.meta.url)),Me=h.lazy(()=>T(()=>import("./GalleryCard-Bvnv_tNy.js"),__vite__mapDeps([5,1,2,6,3,7,8,9]),import.meta.url));function _e(e){return!e.includes("redgifs")&&(e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".webp")||e.endsWith(".png")||e.endsWith(".gif")||e.endsWith(".webp"))}function Le({post:e}){const{title:n,url:s}=e;return t.jsxs("div",{children:[t.jsx(ke,{post:e}),s.startsWith("https://www.reddit.com/gallery")?t.jsx(Me,{post:e}):s.includes("redgifs")?t.jsx(Te,{post:e}):_e(s)?t.jsx(Ee,{title:n,url:s}):t.jsxs("div",{children:["We do not know how to embed this post type yet!"," ",t.jsxs("a",{href:s,children:[s," ",n]})]})]})}function Ae({totalFiltered:e}){const n=w(),{redGifsOnly:s}=n;return t.jsxs(t.Fragment,{children:[t.jsx("h1",{children:"Check your filters in the settings or this may just have been a page of comments if you are browsing a user page"}),s?t.jsxs("div",{children:["Note: RedGifs only is on.",t.jsx(le,{onClick:()=>{n.setRedGifsOnly(!s)},children:"Turn off RedGifs only"})]}):null,t.jsx("div",{children:e?t.jsxs("div",{children:["Total posts filtered out (non-image posts, not matching filters, etc): ",e]}):null}),t.jsx("div",{children:"Note that we are not able to embed v.redd.it videos from e.g. popular SFW reddits"})]})}function Ve({posts:e,stats:n}){const{fullscreen:s}=w();return t.jsx("div",{className:"flex justify-center overflow-hidden",children:t.jsx("div",{className:s?"lg:w-11/12":"lg:w-1/2",children:t.jsx("div",{className:"flex flex-col space-y-20",children:e.length>0?e.map(r=>t.jsx(Le,{post:r},r.id)):n?t.jsx(Ae,{totalPosts:n.totalPosts,commentTypeFiltered:n.commentTypeFiltered,urlTypeFiltered:n.urlTypeFiltered,gifFiltered:n.gifFiltered,redGifsOnlyFiltered:n.redGifsOnlyFiltered,noRedGifsFiltered:n.noRedGifsFiltered,pinnedFiltered:n.pinnedFiltered,blockedFiltered:n.blockedFiltered,remainingPosts:n.remainingPosts,totalFiltered:n.totalPosts-n.remainingPosts}):null})})})}function $e(){return t.jsx("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",style:{width:100,height:100},viewBox:"0 0 24 24",children:t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})})}export{Ve as C,fe as E,Ee as I,$e as L,Z as d};
//# sourceMappingURL=LoadingSpinner-DUgjL8rx.js.map
