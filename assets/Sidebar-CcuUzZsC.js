const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SavedPostFeed-D2CvHVdG.js","./index-CNjTN_Kv.js","./index-Cep78dlH.css","./LoadingSpinner-BxfYH3QB.js","./BaseDialog-BrezZuZq.js","./Link-2WspMnrT.js","./formatDistanceToNowStrict-BGM-HUpS.js","./en-US-A-7Ux56e.js","./RedditPostFeed-C1TjhLeV.js","./EditFeedDialog-aagJerAl.js"])))=>i.map(i=>d[i]);
import{u as L,a as it,j as r,r as x,_ as Me,G as H,L as Se,M as Et,b as bt,c as Ne,d as oe,B as K,n as ee,i as G,e as jt,R as ke,S as Rt}from"./index-CNjTN_Kv.js";import{F as yt,a as Ct,B as Ot}from"./BaseDialog-BrezZuZq.js";const _t=x.lazy(()=>Me(()=>import("./SavedPostFeed-D2CvHVdG.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),Dt=x.lazy(()=>Me(()=>import("./RedditPostFeed-C1TjhLeV.js"),__vite__mapDeps([8,1,2,3,4,5,6,7]),import.meta.url));function In(){const{defaultPage:e}=L(),t=it(e);return r.jsx(x.Suspense,{fallback:null,children:t==="savedposts"?r.jsx(_t,{}):r.jsx(Dt,{})})}function An(e){return H({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(e)}function Mn(e){return H({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(e)}function Lt(e){return H({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function Nn(e){return H({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function ot(e){return H({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function at(e){return H({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function Vt(e){return H({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(e)}function Tt(e){return H({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528.12 301.319l47.273-208C578.806 78.301 567.391 64 551.99 64H159.208l-9.166-44.81C147.758 8.021 137.93 0 126.529 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24h69.883l70.248 343.435C147.325 417.1 136 435.222 136 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-15.674-6.447-29.835-16.824-40h209.647C430.447 426.165 424 440.326 424 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-22.172-12.888-41.332-31.579-50.405l5.517-24.276c3.413-15.018-8.002-29.319-23.403-29.319H218.117l-6.545-32h293.145c11.206 0 20.92-7.754 23.403-18.681z"},child:[]}]})(e)}function Ft(e){return H({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function te({children:e,onClick:t}){return r.jsx("div",{className:"hover:bg-gray-300 dark:hover:bg-gray-600 cursor-pointer whitespace-nowrap",onClick:t,children:e})}function pe({children:e}){return r.jsx("div",{className:"border-b border-r-slate-600 pb-2 pt-2",children:e})}function It(){const e=L();return r.jsxs(pe,{children:[r.jsx(Se,{to:"/savedposts",children:r.jsxs(te,{children:[r.jsx(Vt,{className:"inline"})," Saved posts"]})}),r.jsxs(te,{onClick:()=>{e.setCurrentlyOpenDialog("multi")},children:[r.jsx(Tt,{className:"inline"})," Make list"]}),r.jsxs(te,{onClick:()=>{e.setCurrentlyOpenDialog("blocked")},children:[r.jsx(Et,{className:"inline"})," Blocked users"]}),r.jsxs(te,{onClick:()=>{e.setCurrentlyOpenDialog("about")},children:[r.jsx(bt,{className:"inline"})," About"]})]})}function ne({label:e,localStorageKey:t,list:n}){const s=L(),i=Ne(),[c,o]=oe(t,!0),[a,f]=oe("showMore-"+t,!0);return r.jsxs(pe,{children:[r.jsxs("div",{className:"flex gap-1",children:[e,":",r.jsx(K,{onClick:()=>{o(!c)},children:c?r.jsx(yt,{className:"inline"}):r.jsx(Ct,{className:"inline"})}),r.jsx(K,{onClick:()=>{f(!a)},children:a?"Show less":"Show more"})]}),c?r.jsx("div",{children:n.length>0?n.slice(0,a?1e3:7).map(p=>r.jsx(Se,{to:p.name,onClick:()=>{i&&s.setSidebarOpen(!1)},children:r.jsxs(te,{children:["- ",ee(p.name),p.visitedCount?`(${p.visitedCount})`:""]})},p.name)):"No items"}):null]})}function At(){const e=L(),{favorites:t}=e;return r.jsx(ne,{label:"Favorite subreddits",localStorageKey:"favSubreddits",list:t.filter(n=>!G(n.name))})}function Mt(){const e=L(),{favorites:t}=e;return r.jsx(ne,{label:"Favorite users",localStorageKey:"favUsers",list:t.filter(n=>G(n.name))})}function Nt({children:e,onClick:t}){return r.jsx("span",{className:"hover:bg-gray-300 dark:hover:bg-gray-600 cursor-pointer m-1 whitespace-nowrap",onClick:t,children:e})}const kt=x.lazy(()=>Me(()=>import("./EditFeedDialog-aagJerAl.js"),__vite__mapDeps([9,1,2,4]),import.meta.url));function Pt({feed:e}){const t=L(),[n,s]=x.useState(!1);return r.jsxs("div",{children:[r.jsx(Se,{to:`/r/${e.subreddits.join("+")}`,children:r.jsxs(Nt,{children:["- ",e.name]})}),r.jsx(K,{onClick:()=>{s(!0)},children:r.jsx(Lt,{})}),r.jsx(K,{onClick:()=>{t.removeFeed(e.name)},children:r.jsx(Ft,{})}),n?r.jsx(x.Suspense,{fallback:null,children:r.jsx(kt,{onClose:()=>{s(!1)},feed:e})}):null]})}function Ht(){const e=L(),{feeds:t}=e,[n,s]=oe("showFeeds",!0);return t.length>0?r.jsxs(pe,{children:[r.jsxs("div",{children:["Feeds:"," ",r.jsx(K,{onClick:()=>{s(!n)},children:n?r.jsx(ot,{className:"inline"}):r.jsx(at,{className:"inline"})})]}),n?t.map(i=>r.jsx(Pt,{feed:i},i.name)):null]}):null}function $t(){const e=L(),{recentlyVisited:t}=e,n=new Set(e.feeds.map(s=>`r/${s.subreddits.join("+")}`));return r.jsx(ne,{list:t.filter(s=>!G(s.name)).toSorted((s,i)=>i.visitedCount-s.visitedCount).filter(s=>!n.has(s.name)),label:"Most visited subreddits",localStorageKey:"mostVisitedSubreddits"})}function Wt(){const e=L(),{recentlyVisited:t}=e,n=new Set(e.feeds.map(s=>`r/${s.subreddits.join("+")}`));return r.jsx(ne,{list:t.filter(s=>G(s.name)).toSorted((s,i)=>i.visitedCount-s.visitedCount).filter(s=>!n.has(s.name)),label:"Most visited users",localStorageKey:"mostVisitedUsers"})}function zt(){const e=L(),{recentlyVisited:t}=e,n=new Set(e.feeds.map(s=>`r/${s.subreddits.join("+")}`));return r.jsx(ne,{label:"Recently visited subreddits",localStorageKey:"recentlyVisitedSubreddits",list:t.filter(s=>!G(s.name)).toSorted((s,i)=>+i.lastVisited-+s.lastVisited).filter(s=>!n.has(s.name))})}function Bt(){const e=L(),{recentlyVisited:t}=e,n=new Set(e.feeds.map(s=>`r/${s.subreddits.join("+")}`));return r.jsx(ne,{label:"Recently visited users",localStorageKey:"recentlyVisitedUsers",list:t.filter(s=>G(s.name)).toSorted((s,i)=>+i.lastVisited-+s.lastVisited).filter(s=>!n.has(s.name))})}var xe={exports:{}},Ee={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xe;function Ut(){if(Xe)return Ee;Xe=1;var e=jt();function t(d,l){return d===l&&(d!==0||1/d===1/l)||d!==d&&l!==l}var n=typeof Object.is=="function"?Object.is:t,s=e.useState,i=e.useEffect,c=e.useLayoutEffect,o=e.useDebugValue;function a(d,l){var m=l(),D=s({inst:{value:m,getSnapshot:l}}),v=D[0].inst,B=D[1];return c(function(){v.value=m,v.getSnapshot=l,f(v)&&B({inst:v})},[d,m,l]),i(function(){return f(v)&&B({inst:v}),d(function(){f(v)&&B({inst:v})})},[d]),o(m),m}function f(d){var l=d.getSnapshot;d=d.value;try{var m=l();return!n(d,m)}catch{return!0}}function p(d,l){return l()}var E=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:a;return Ee.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:E,Ee}var Qe;function qt(){return Qe||(Qe=1,xe.exports=Ut()),xe.exports}var Kt=qt();const ct=0,lt=1,ut=2,Ze=3;var et=Object.prototype.hasOwnProperty;function _e(e,t){var n,s;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((s=e.length)===t.length)for(;s--&&_e(e[s],t[s]););return s===-1}if(!n||typeof e=="object"){s=0;for(n in e)if(et.call(e,n)&&++s&&!et.call(t,n)||!(n in t)||!_e(e[n],t[n]))return!1;return Object.keys(t).length===s}}return e!==e&&t!==t}const P=new WeakMap,W=()=>{},C=W(),De=Object,h=e=>e===C,A=e=>typeof e=="function",z=(e,t)=>({...e,...t}),dt=e=>A(e.then),be={},he={},Pe="undefined",ce=typeof window!=Pe,Le=typeof document!=Pe,Gt=ce&&"Deno"in window,Jt=()=>ce&&typeof window.requestAnimationFrame!=Pe,ft=(e,t)=>{const n=P.get(e);return[()=>!h(t)&&e.get(t)||be,s=>{if(!h(t)){const i=e.get(t);t in he||(he[t]=i),n[5](t,z(i,s),i||be)}},n[6],()=>!h(t)&&t in he?he[t]:!h(t)&&e.get(t)||be]};let Ve=!0;const Yt=()=>Ve,[Te,Fe]=ce&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[W,W],Xt=()=>{const e=Le&&document.visibilityState;return h(e)||e!=="hidden"},Qt=e=>(Le&&document.addEventListener("visibilitychange",e),Te("focus",e),()=>{Le&&document.removeEventListener("visibilitychange",e),Fe("focus",e)}),Zt=e=>{const t=()=>{Ve=!0,e()},n=()=>{Ve=!1};return Te("online",t),Te("offline",n),()=>{Fe("online",t),Fe("offline",n)}},en={isOnline:Yt,isVisible:Xt},tn={initFocus:Qt,initReconnect:Zt},tt=!ke.useId,ae=!ce||Gt,nn=e=>Jt()?window.requestAnimationFrame(e):setTimeout(e,1),je=ae?x.useEffect:x.useLayoutEffect,Re=typeof navigator<"u"&&navigator.connection,nt=!ae&&Re&&(["slow-2g","2g"].includes(Re.effectiveType)||Re.saveData),me=new WeakMap,sn=e=>De.prototype.toString.call(e),ye=(e,t)=>e===`[object ${t}]`;let rn=0;const Ie=e=>{const t=typeof e,n=sn(e),s=ye(n,"Date"),i=ye(n,"RegExp"),c=ye(n,"Object");let o,a;if(De(e)===e&&!s&&!i){if(o=me.get(e),o)return o;if(o=++rn+"~",me.set(e,o),Array.isArray(e)){for(o="@",a=0;a<e.length;a++)o+=Ie(e[a])+",";me.set(e,o)}if(c){o="#";const f=De.keys(e).sort();for(;!h(a=f.pop());)h(e[a])||(o+=a+":"+Ie(e[a])+",");me.set(e,o)}}else o=s?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return o},He=e=>{if(A(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?Ie(e):"",[e,t]};let on=0;const Ae=()=>++on;async function ht(...e){const[t,n,s,i]=e,c=z({populateCache:!0,throwOnError:!0},typeof i=="boolean"?{revalidate:i}:i||{});let o=c.populateCache;const a=c.rollbackOnError;let f=c.optimisticData;const p=l=>typeof a=="function"?a(l):a!==!1,E=c.throwOnError;if(A(n)){const l=n,m=[],D=t.keys();for(const v of D)!/^\$(inf|sub)\$/.test(v)&&l(t.get(v)._k)&&m.push(v);return Promise.all(m.map(d))}return d(n);async function d(l){const[m]=He(l);if(!m)return;const[D,v]=ft(t,m),[B,u,le,se]=P.get(t),$=()=>{const O=B[m];return(A(c.revalidate)?c.revalidate(D().data,l):c.revalidate!==!1)&&(delete le[m],delete se[m],O&&O[0])?O[0](ut).then(()=>D().data):D().data};if(e.length<3)return $();let y=s,M,F=!1;const b=Ae();u[m]=[b,0];const J=!h(f),I=D(),Y=I.data,ue=I._c,U=h(ue)?Y:ue;if(J&&(f=A(f)?f(U,Y):f,v({data:f,_c:U})),A(y))try{y=y(U)}catch(O){M=O,F=!0}if(y&&dt(y))if(y=await y.catch(O=>{M=O,F=!0}),b!==u[m][0]){if(F)throw M;return y}else F&&J&&p(M)&&(o=!0,v({data:U,_c:C}));if(o&&!F)if(A(o)){const O=o(y,U);v({data:O,error:C,_c:C})}else v({data:y,error:C,_c:C});if(u[m][1]=Ae(),Promise.resolve($()).then(()=>{v({_c:C})}),F){if(E)throw M;return}return y}}const st=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},an=(e,t)=>{if(!P.has(e)){const n=z(tn,t),s=Object.create(null),i=ht.bind(C,e);let c=W;const o=Object.create(null),a=(E,d)=>{const l=o[E]||[];return o[E]=l,l.push(d),()=>l.splice(l.indexOf(d),1)},f=(E,d,l)=>{e.set(E,d);const m=o[E];if(m)for(const D of m)D(d,l)},p=()=>{if(!P.has(e)&&(P.set(e,[s,Object.create(null),Object.create(null),Object.create(null),i,f,a]),!ae)){const E=n.initFocus(setTimeout.bind(C,st.bind(C,s,ct))),d=n.initReconnect(setTimeout.bind(C,st.bind(C,s,lt)));c=()=>{E&&E(),d&&d(),P.delete(e)}}};return p(),[e,i,p,c]}return[e,P.get(e)[4]]},cn=(e,t,n,s,i)=>{const c=n.errorRetryCount,o=i.retryCount,a=~~((Math.random()+.5)*(1<<(o<8?o:8)))*n.errorRetryInterval;!h(c)&&o>c||setTimeout(s,a,i)},ln=_e,[mt,un]=an(new Map),dn=z({onLoadingSlow:W,onSuccess:W,onError:W,onErrorRetry:cn,onDiscarded:W,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:nt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:nt?5e3:3e3,compare:ln,isPaused:()=>!1,cache:mt,mutate:un,fallback:{}},en),fn=(e,t)=>{const n=z(e,t);if(t){const{use:s,fallback:i}=e,{use:c,fallback:o}=t;s&&c&&(n.use=s.concat(c)),i&&o&&(n.fallback=z(i,o))}return n},hn=x.createContext({}),mn="$inf$",St=ce&&window.__SWR_DEVTOOLS_USE__,Sn=St?window.__SWR_DEVTOOLS_USE__:[],pn=()=>{St&&(window.__SWR_DEVTOOLS_REACT__=ke)},pt=e=>A(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],vn=()=>{const e=x.useContext(hn);return x.useMemo(()=>z(dn,e),[e])},gn=e=>(t,n,s)=>e(t,n&&((...c)=>{const[o]=He(t),[,,,a]=P.get(mt);if(o.startsWith(mn))return n(...c);const f=a[o];return h(f)?n(...c):(delete a[o],f)}),s),wn=Sn.concat(gn),xn=e=>function(...n){const s=vn(),[i,c,o]=pt(n),a=fn(s,o);let f=e;const{use:p}=a,E=(p||[]).concat(wn);for(let d=E.length;d--;)f=E[d](f);return f(i,c||a.fetcher||null,a)},En=(e,t,n)=>{const s=t[e]||(t[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i>=0&&(s[i]=s[s.length-1],s.pop())}},kn=(e,t)=>(...n)=>{const[s,i,c]=pt(n),o=(c.use||[]).concat(t);return e(s,i,{...c,use:o})};pn();const Ce=ke.use||(e=>{switch(e.status){case"pending":throw e;case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e}}),Oe={dedupe:!0},rt=Promise.resolve(C),bn=(e,t,n)=>{const{cache:s,compare:i,suspense:c,fallbackData:o,revalidateOnMount:a,revalidateIfStale:f,refreshInterval:p,refreshWhenHidden:E,refreshWhenOffline:d,keepPreviousData:l}=n,[m,D,v,B]=P.get(s),[u,le]=He(e),se=x.useRef(!1),$=x.useRef(!1),y=x.useRef(u),M=x.useRef(t),F=x.useRef(n),b=()=>F.current,J=()=>b().isVisible()&&b().isOnline(),[I,Y,ue,U]=ft(s,u),O=x.useRef({}).current,re=h(o)?h(n.fallback)?C:n.fallback[u]:o,We=(S,w)=>{for(const j in O){const g=j;if(g==="data"){if(!i(S[g],w[g])&&(!h(S[g])||!i(fe,w[g])))return!1}else if(w[g]!==S[g])return!1}return!0},ze=x.useMemo(()=>{const S=!u||!t?!1:h(a)?b().isPaused()||c?!1:f!==!1:a,w=_=>{const N=z(_);return delete N._k,S?{isValidating:!0,isLoading:!0,...N}:N},j=I(),g=U(),T=w(j),Z=j===g?T:w(g);let R=T;return[()=>{const _=w(I());return We(_,R)?(R.data=_.data,R.isLoading=_.isLoading,R.isValidating=_.isValidating,R.error=_.error,R):(R=_,_)},()=>Z]},[s,u]),X=Kt.useSyncExternalStore(x.useCallback(S=>ue(u,(w,j)=>{We(j,w)||S()}),[s,u]),ze[0],ze[1]),Be=!se.current,vt=m[u]&&m[u].length>0,Q=X.data,q=h(Q)?re&&dt(re)?Ce(re):re:Q,de=X.error,ve=x.useRef(q),fe=l?h(Q)?h(ve.current)?q:ve.current:Q:q,Ue=vt&&!h(de)?!1:Be&&!h(a)?a:b().isPaused()?!1:c?h(q)?!1:f:h(q)||f,qe=!!(u&&t&&Be&&Ue),gt=h(X.isValidating)?qe:X.isValidating,wt=h(X.isLoading)?qe:X.isLoading,ie=x.useCallback(async S=>{const w=M.current;if(!u||!w||$.current||b().isPaused())return!1;let j,g,T=!0;const Z=S||{},R=!v[u]||!Z.dedupe,_=()=>tt?!$.current&&u===y.current&&se.current:u===y.current,N={isValidating:!1,isLoading:!1},Ge=()=>{Y(N)},Je=()=>{const V=v[u];V&&V[1]===g&&delete v[u]},Ye={isValidating:!0};h(I().data)&&(Ye.isLoading=!0);try{if(R&&(Y(Ye),n.loadingTimeout&&h(I().data)&&setTimeout(()=>{T&&_()&&b().onLoadingSlow(u,n)},n.loadingTimeout),v[u]=[w(le),Ae()]),[j,g]=v[u],j=await j,R&&setTimeout(Je,n.dedupingInterval),!v[u]||v[u][1]!==g)return R&&_()&&b().onDiscarded(u),!1;N.error=C;const V=D[u];if(!h(V)&&(g<=V[0]||g<=V[1]||V[1]===0))return Ge(),R&&_()&&b().onDiscarded(u),!1;const k=I().data;N.data=i(k,j)?k:j,R&&_()&&b().onSuccess(j,u,n)}catch(V){Je();const k=b(),{shouldRetryOnError:ge}=k;k.isPaused()||(N.error=V,R&&_()&&(k.onError(V,u,k),(ge===!0||A(ge)&&ge(V))&&(!b().revalidateOnFocus||!b().revalidateOnReconnect||J())&&k.onErrorRetry(V,u,k,xt=>{const we=m[u];we&&we[0]&&we[0](Ze,xt)},{retryCount:(Z.retryCount||0)+1,dedupe:!0})))}return T=!1,Ge(),!0},[u,s]),Ke=x.useCallback((...S)=>ht(s,y.current,...S),[]);if(je(()=>{M.current=t,F.current=n,h(Q)||(ve.current=Q)}),je(()=>{if(!u)return;const S=ie.bind(C,Oe);let w=0;b().revalidateOnFocus&&(w=Date.now()+b().focusThrottleInterval);const g=En(u,m,(T,Z={})=>{if(T==ct){const R=Date.now();b().revalidateOnFocus&&R>w&&J()&&(w=R+b().focusThrottleInterval,S())}else if(T==lt)b().revalidateOnReconnect&&J()&&S();else{if(T==ut)return ie();if(T==Ze)return ie(Z)}});return $.current=!1,y.current=u,se.current=!0,Y({_k:le}),Ue&&(v[u]||(h(q)||ae?S():nn(S))),()=>{$.current=!0,g()}},[u]),je(()=>{let S;function w(){const g=A(p)?p(I().data):p;g&&S!==-1&&(S=setTimeout(j,g))}function j(){!I().error&&(E||b().isVisible())&&(d||b().isOnline())?ie(Oe).then(w):w()}return w(),()=>{S&&(clearTimeout(S),S=-1)}},[p,E,d,u]),x.useDebugValue(fe),c){const S=u&&h(q);if(!tt&&ae&&S)throw new Error("Fallback data is required when using Suspense in SSR.");S&&(M.current=t,F.current=n,$.current=!1);const w=B[u],j=!h(w)&&S?Ke(w):rt;if(Ce(j),!h(de)&&S)throw de;const g=S?ie(Oe):rt;!h(fe)&&S&&(g.status="fulfilled",g.value=!0),Ce(g)}return{mutate:Ke,get data(){return O.data=!0,fe},get error(){return O.error=!0,de},get isValidating(){return O.isValidating=!0,gt},get isLoading(){return O.isLoading=!0,wt}}},jn=xn(bn);async function $e(e){const t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status} fetching ${e}: ${await t.text()}`);return t}async function Rn(e){return(await $e(e)).text()}async function yn(e){return(await $e(e)).arrayBuffer()}async function Pn(e){return(await $e(e)).json()}async function Cn(){const t=(await Rn("node-ids.txt")).split(`
`);let n;const s=await yn("links.bin"),i=new DataView(s),c=[];for(let a=0;a<i.byteLength;a+=4){const f=i.getInt32(a,!0);if(f<0)n=-f-1;else{const p=f-1;c.push([t[n],t[p]])}}const o={};for(let a=0,f=c.length;a<f;a++){const[p,E]=c[a];o[p]??=[],o[p].push(E)}return o}function On(){const e=L(),{defaultPage:t,recentlyVisited:n}=e,s=it(t),{data:i,isLoading:c,error:o}=jn("graph",()=>Cn(),{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1}),[a,f]=oe("showSimilar",!0),[p,E]=oe("showMoreSimilar",!0),d=Object.fromEntries(n.map(l=>[l.name,l]));return G(s)?null:r.jsxs(pe,{children:[r.jsxs("div",{children:["Similar subreddits:",r.jsx(K,{onClick:()=>{f(!a)},children:a?r.jsx(ot,{className:"inline"}):r.jsx(at,{className:"inline"})}),r.jsx(K,{className:"ml-1",onClick:()=>{E(!p)},children:p?"Show less":"Show more"})]}),a?r.jsxs("div",{children:[c?r.jsx("div",{children:"Loading"}):null,o?r.jsx("div",{className:"text-error",children:`${o}`}):null,i?r.jsx("div",{children:[...new Set(i[ee(s).replace("r/","")]??[])].map(l=>`/r/${l}`).toSorted((l,m)=>((d[ee(l)]?.visitedCount??0)-(d[ee(m)]?.visitedCount??0))*-1).slice(0,p?1e3:7).map(l=>r.jsx(Se,{to:l,children:r.jsxs(te,{children:["- ",ee(l)," (",d[ee(l)]?.visitedCount??0,")"]})},l))}):null]}):null]})}function _n({children:e}){return r.jsx("div",{className:"mt-3 mb-20",children:e})}function Dn({children:e}){const t=L();return r.jsx(Ot,{open:!0,onClose:()=>{t.setSidebarOpen(!1)},children:r.jsx("div",{className:"w-screen h-screen",children:e})})}function Ln({children:e}){return Ne()?r.jsx(Dn,{children:e}):r.jsx(_n,{children:e})}function Hn(){const e=Ne();return r.jsxs(Ln,{children:[e?r.jsx(Rt,{}):null,r.jsx(On,{}),r.jsx($t,{}),r.jsx(Wt,{}),r.jsx(zt,{}),r.jsx(Bt,{}),r.jsx(At,{}),r.jsx(Mt,{}),r.jsx(Ht,{}),r.jsx(It,{})]})}export{In as F,mn as I,Hn as S,C as U,P as a,ft as b,mt as c,je as d,He as e,A as f,Nn as g,Vt as h,h as i,An as j,Mn as k,Pn as m,Kt as s,jn as u,kn as w};
//# sourceMappingURL=Sidebar-CcuUzZsC.js.map
