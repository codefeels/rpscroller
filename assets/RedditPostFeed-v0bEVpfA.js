import{r as E,R as It,u as re,a as oe,m as ie,j as J}from"./index-DCj3gC3n.js";import{L as zt,E as ae,C as ce}from"./CardList-CZcPXtJq.js";import"./Link-Di0yGxod.js";import"./formatDistanceToNowStrict-DGPDrA_T.js";import"./en-US-Ckk-QizZ.js";var Ht={exports:{}},Kt={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ot=E;function ue(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var le=typeof Object.is=="function"?Object.is:ue,fe=ot.useState,de=ot.useEffect,Ee=ot.useLayoutEffect,he=ot.useDebugValue;function Re(t,e){var n=e(),i=fe({inst:{value:n,getSnapshot:e}}),s=i[0].inst,r=i[1];return Ee(function(){s.value=n,s.getSnapshot=e,wt(s)&&r({inst:s})},[t,n,e]),de(function(){return wt(s)&&r({inst:s}),t(function(){wt(s)&&r({inst:s})})},[t]),he(n),n}function wt(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!le(t,n)}catch{return!0}}function pe(t,e){return e()}var ge=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?pe:Re;Kt.useSyncExternalStore=ot.useSyncExternalStore!==void 0?ot.useSyncExternalStore:ge;Ht.exports=Kt;var Bt=Ht.exports;const X=()=>{},D=X(),_t=Object,c=t=>t===D,$=t=>typeof t=="function",Q=(t,e)=>({...t,...e}),me=t=>$(t.then),ht=new WeakMap;let ve=0;const ft=t=>{const e=typeof t,n=t&&t.constructor,i=n==Date;let s,r;if(_t(t)===t&&!i&&n!=RegExp){if(s=ht.get(t),s)return s;if(s=++ve+"~",ht.set(t,s),n==Array){for(s="@",r=0;r<t.length;r++)s+=ft(t[r])+",";ht.set(t,s)}if(n==_t){s="#";const f=_t.keys(t).sort();for(;!c(r=f.pop());)c(t[r])||(s+=r+":"+ft(t[r])+",");ht.set(t,s)}}else s=i?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},k=new WeakMap,Tt={},Rt={},xt="undefined",gt=typeof window!=xt,bt=typeof document!=xt,Se=()=>gt&&typeof window.requestAnimationFrame!=xt,G=(t,e)=>{const n=k.get(t);return[()=>!c(e)&&t.get(e)||Tt,i=>{if(!c(e)){const s=t.get(e);e in Rt||(Rt[e]=s),n[5](e,Q(s,i),s||Tt)}},n[6],()=>!c(e)&&e in Rt?Rt[e]:!c(e)&&t.get(e)||Tt]};let Dt=!0;const we=()=>Dt,[At,Lt]=gt&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[X,X],_e=()=>{const t=bt&&document.visibilityState;return c(t)||t!=="hidden"},Te=t=>(bt&&document.addEventListener("visibilitychange",t),At("focus",t),()=>{bt&&document.removeEventListener("visibilitychange",t),Lt("focus",t)}),Ce=t=>{const e=()=>{Dt=!0,t()},n=()=>{Dt=!1};return At("online",e),At("offline",n),()=>{Lt("online",e),Lt("offline",n)}},Oe={isOnline:we,isVisible:_e},ye={initFocus:Te,initReconnect:Ce},Ut=!It.useId,dt=!gt||"Deno"in window,be=t=>Se()?window.requestAnimationFrame(t):setTimeout(t,1),pt=dt?E.useEffect:E.useLayoutEffect,Ct=typeof navigator<"u"&&navigator.connection,$t=!dt&&Ct&&(["slow-2g","2g"].includes(Ct.effectiveType)||Ct.saveData),it=t=>{if($(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?ft(t):"",[t,e]};let De=0;const Vt=()=>++De,Jt=0,Yt=1,Gt=2,Ae=3;var lt={__proto__:null,ERROR_REVALIDATE_EVENT:Ae,FOCUS_EVENT:Jt,MUTATE_EVENT:Gt,RECONNECT_EVENT:Yt};async function Xt(...t){const[e,n,i,s]=t,r=Q({populateCache:!0,throwOnError:!0},typeof s=="boolean"?{revalidate:s}:s||{});let f=r.populateCache;const S=r.rollbackOnError;let u=r.optimisticData;const C=_=>typeof S=="function"?S(_):S!==!1,w=r.throwOnError;if($(n)){const _=n,a=[],O=e.keys();for(const p of O)!/^\$(inf|sub)\$/.test(p)&&_(e.get(p)._k)&&a.push(p);return Promise.all(a.map(R))}return R(n);async function R(_){const[a]=it(_);if(!a)return;const[O,p]=G(e,a),[et,o,F,z]=k.get(e),M=()=>{const L=et[a];return($(r.revalidate)?r.revalidate(O().data,_):r.revalidate!==!1)&&(delete F[a],delete z[a],L&&L[0])?L[0](Gt).then(()=>O().data):O().data};if(t.length<3)return M();let d=i,h;const H=Vt();o[a]=[H,0];const l=!c(u),P=O(),g=P.data,A=P._c,U=c(A)?g:A;if(l&&(u=$(u)?u(U,g):u,p({data:u,_c:U})),$(d))try{d=d(U)}catch(L){h=L}if(d&&me(d))if(d=await d.catch(L=>{h=L}),H!==o[a][0]){if(h)throw h;return d}else h&&l&&C(h)&&(f=!0,p({data:U,_c:D}));if(f&&!h)if($(f)){const L=f(d,U);p({data:L,error:D,_c:D})}else p({data:d,error:D,_c:D});if(o[a][1]=Vt(),Promise.resolve(M()).then(()=>{p({_c:D})}),h){if(w)throw h;return}return d}}const qt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},Le=(t,e)=>{if(!k.has(t)){const n=Q(ye,e),i={},s=Xt.bind(D,t);let r=X;const f={},S=(w,R)=>{const _=f[w]||[];return f[w]=_,_.push(R),()=>_.splice(_.indexOf(R),1)},u=(w,R,_)=>{t.set(w,R);const a=f[w];if(a)for(const O of a)O(R,_)},C=()=>{if(!k.has(t)&&(k.set(t,[i,{},{},{},s,u,S]),!dt)){const w=n.initFocus(setTimeout.bind(D,qt.bind(D,i,Jt))),R=n.initReconnect(setTimeout.bind(D,qt.bind(D,i,Yt)));r=()=>{w&&w(),R&&R(),k.delete(t)}}};return C(),[t,s,C,r]}return[t,k.get(t)[4]]},Ve=(t,e,n,i,s)=>{const r=n.errorRetryCount,f=s.retryCount,S=~~((Math.random()+.5)*(1<<(f<8?f:8)))*n.errorRetryInterval;!c(r)&&f>r||setTimeout(i,S,s)},Ie=(t,e)=>ft(t)==ft(e),[Nt,xe]=Le(new Map),Ne=Q({onLoadingSlow:X,onSuccess:X,onError:X,onErrorRetry:Ve,onDiscarded:X,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:$t?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:$t?5e3:3e3,compare:Ie,isPaused:()=>!1,cache:Nt,mutate:xe,fallback:{}},Oe),Fe=(t,e)=>{const n=Q(t,e);if(e){const{use:i,fallback:s}=t,{use:r,fallback:f}=e;i&&r&&(n.use=i.concat(r)),s&&f&&(n.fallback=Q(s,f))}return n},Pe=E.createContext({}),Qt="$inf$",Zt=gt&&window.__SWR_DEVTOOLS_USE__,Me=Zt?window.__SWR_DEVTOOLS_USE__:[],We=()=>{Zt&&(window.__SWR_DEVTOOLS_REACT__=It)},te=t=>$(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],je=()=>Q(Ne,E.useContext(Pe)),ze=t=>(e,n,i)=>t(e,n&&((...r)=>{const[f]=it(e),[,,,S]=k.get(Nt);if(f.startsWith(Qt))return n(...r);const u=S[f];return c(u)?n(...r):(delete S[f],u)}),i),Ue=Me.concat(ze),$e=t=>function(...n){const i=je(),[s,r,f]=te(n),S=Fe(i,f);let u=t;const{use:C}=S,w=(C||[]).concat(Ue);for(let R=w.length;R--;)u=w[R](u);return u(s,r||S.fetcher||null,S)},qe=(t,e,n)=>{const i=e[t]||(e[t]=[]);return i.push(n),()=>{const s=i.indexOf(n);s>=0&&(i[s]=i[i.length-1],i.pop())}},ke=(t,e)=>(...n)=>{const[i,s,r]=te(n),f=(r.use||[]).concat(e);return t(i,s,{...r,use:f})};We();const kt=It.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),Ot={dedupe:!0},He=(t,e,n)=>{const{cache:i,compare:s,suspense:r,fallbackData:f,revalidateOnMount:S,revalidateIfStale:u,refreshInterval:C,refreshWhenHidden:w,refreshWhenOffline:R,keepPreviousData:_}=n,[a,O,p,et]=k.get(i),[o,F]=it(t),z=E.useRef(!1),M=E.useRef(!1),d=E.useRef(o),h=E.useRef(e),H=E.useRef(n),l=()=>H.current,P=()=>l().isVisible()&&l().isOnline(),[g,A,U,L]=G(i,o),x=E.useRef({}).current,Z=c(f)?n.fallback[o]:f,tt=(m,v)=>{for(const I in x){const T=I;if(T==="data"){if(!s(m[T],v[T])&&(!c(m[T])||!s(ct,v[T])))return!1}else if(v[T]!==m[T])return!1}return!0},y=E.useMemo(()=>{const m=!o||!e?!1:c(S)?l().isPaused()||r?!1:c(u)?!0:u:S,v=N=>{const K=Q(N);return delete K._k,m?{isValidating:!0,isLoading:!0,...K}:K},I=g(),T=L(),q=v(I),rt=I===T?q:v(T);let b=q;return[()=>{const N=v(g());return tt(N,b)?(b.data=N.data,b.isLoading=N.isLoading,b.isValidating=N.isValidating,b.error=N.error,b):(b=N,N)},()=>rt]},[i,o]),W=Bt.useSyncExternalStore(E.useCallback(m=>U(o,(v,I)=>{tt(I,v)||m()}),[i,o]),y[0],y[1]),nt=!z.current,mt=a[o]&&a[o].length>0,Y=W.data,V=c(Y)?Z:Y,st=W.error,at=E.useRef(V),ct=_?c(Y)?at.current:Y:V,Et=mt&&!c(st)?!1:nt&&!c(S)?S:l().isPaused()?!1:r?c(V)?!1:u:c(V)||u,Ft=!!(o&&e&&nt&&Et),ee=c(W.isValidating)?Ft:W.isValidating,ne=c(W.isLoading)?Ft:W.isLoading,ut=E.useCallback(async m=>{const v=h.current;if(!o||!v||M.current||l().isPaused())return!1;let I,T,q=!0;const rt=m||{},b=!p[o]||!rt.dedupe,N=()=>Ut?!M.current&&o===d.current&&z.current:o===d.current,K={isValidating:!1,isLoading:!1},Mt=()=>{A(K)},Wt=()=>{const j=p[o];j&&j[1]===T&&delete p[o]},jt={isValidating:!0};c(g().data)&&(jt.isLoading=!0);try{if(b&&(A(jt),n.loadingTimeout&&c(g().data)&&setTimeout(()=>{q&&N()&&l().onLoadingSlow(o,n)},n.loadingTimeout),p[o]=[v(F),Vt()]),[I,T]=p[o],I=await I,b&&setTimeout(Wt,n.dedupingInterval),!p[o]||p[o][1]!==T)return b&&N()&&l().onDiscarded(o),!1;K.error=D;const j=O[o];if(!c(j)&&(T<=j[0]||T<=j[1]||j[1]===0))return Mt(),b&&N()&&l().onDiscarded(o),!1;const B=g().data;K.data=s(B,I)?B:I,b&&N()&&l().onSuccess(I,o,n)}catch(j){Wt();const B=l(),{shouldRetryOnError:vt}=B;B.isPaused()||(K.error=j,b&&N()&&(B.onError(j,o,B),(vt===!0||$(vt)&&vt(j))&&(!l().revalidateOnFocus||!l().revalidateOnReconnect||P())&&B.onErrorRetry(j,o,B,se=>{const St=a[o];St&&St[0]&&St[0](lt.ERROR_REVALIDATE_EVENT,se)},{retryCount:(rt.retryCount||0)+1,dedupe:!0})))}return q=!1,Mt(),!0},[o,i]),Pt=E.useCallback((...m)=>Xt(i,d.current,...m),[]);if(pt(()=>{h.current=e,H.current=n,c(Y)||(at.current=Y)}),pt(()=>{if(!o)return;const m=ut.bind(D,Ot);let v=0;const T=qe(o,a,(q,rt={})=>{if(q==lt.FOCUS_EVENT){const b=Date.now();l().revalidateOnFocus&&b>v&&P()&&(v=b+l().focusThrottleInterval,m())}else if(q==lt.RECONNECT_EVENT)l().revalidateOnReconnect&&P()&&m();else{if(q==lt.MUTATE_EVENT)return ut();if(q==lt.ERROR_REVALIDATE_EVENT)return ut(rt)}});return M.current=!1,d.current=o,z.current=!0,A({_k:F}),Et&&(c(V)||dt?m():be(m)),()=>{M.current=!0,T()}},[o]),pt(()=>{let m;function v(){const T=$(C)?C(g().data):C;T&&m!==-1&&(m=setTimeout(I,T))}function I(){!g().error&&(w||l().isVisible())&&(R||l().isOnline())?ut(Ot).then(v):v()}return v(),()=>{m&&(clearTimeout(m),m=-1)}},[C,w,R,o]),E.useDebugValue(ct),r&&c(V)&&o){if(!Ut&&dt)throw new Error("Fallback data is required when using suspense in SSR.");h.current=e,H.current=n,M.current=!1;const m=et[o];if(!c(m)){const v=Pt(m);kt(v)}if(c(st)){const v=ut(Ot);c(ct)||(v.status="fulfilled",v.value=!0),kt(v)}else throw st}return{mutate:Pt,get data(){return x.data=!0,ct},get error(){return x.error=!0,st},get isValidating(){return x.isValidating=!0,ee},get isLoading(){return x.isLoading=!0,ne}}},Ke=$e(He),Be=t=>it(t?t(0,null):null)[0],yt=Promise.resolve(),Je=t=>(e,n,i)=>{const s=E.useRef(!1),{cache:r,initialSize:f=1,revalidateAll:S=!1,persistSize:u=!1,revalidateFirstPage:C=!0,revalidateOnMount:w=!1,parallel:R=!1}=i,[,,,_]=k.get(Nt);let a;try{a=Be(e),a&&(a=Qt+a)}catch{}const[O,p,et]=G(r,a),o=E.useCallback(()=>c(O()._l)?f:O()._l,[r,a,f]);Bt.useSyncExternalStore(E.useCallback(l=>a?et(a,()=>{l()}):()=>{},[r,a]),o,o);const F=E.useCallback(()=>{const l=O()._l;return c(l)?f:l},[a,f]),z=E.useRef(F());pt(()=>{if(!s.current){s.current=!0;return}a&&p({_l:u?z.current:F()})},[a,r]);const M=w&&!s.current,d=t(a,async l=>{const P=O()._i,g=O()._r;p({_r:D});const A=[],U=F(),[L]=G(r,l),x=L().data,Z=[];let tt=null;for(let y=0;y<U;++y){const[W,nt]=it(e(y,R?null:tt));if(!W)break;const[mt,Y]=G(r,W);let V=mt().data;const st=S||P||c(V)||C&&!y&&!c(x)||M||x&&!c(x[y])&&!i.compare(x[y],V);if(n&&(typeof g=="function"?g(V,nt):st)){const at=async()=>{if(!(W in _))V=await n(nt);else{const Et=_[W];delete _[W],V=await Et}Y({data:V,_k:nt}),A[y]=V};R?Z.push(at):await at()}else A[y]=V;R||(tt=V)}return R&&await Promise.all(Z.map(y=>y())),p({_i:D}),A},i),h=E.useCallback(function(l,P){const g=typeof P=="boolean"?{revalidate:P}:P||{},A=g.revalidate!==!1;return a?(A&&(c(l)?p({_i:!0,_r:g.revalidate}):p({_i:!1,_r:g.revalidate})),arguments.length?d.mutate(l,{...g,revalidate:A}):d.mutate()):yt},[a,r]),H=E.useCallback(l=>{if(!a)return yt;const[,P]=G(r,a);let g;if($(l)?g=l(F()):typeof l=="number"&&(g=l),typeof g!="number")return yt;P({_l:g}),z.current=g;const A=[],[U]=G(r,a);let L=null;for(let x=0;x<g;++x){const[Z]=it(e(x,L)),[tt]=G(r,Z),y=Z?tt().data:D;if(c(y))return h(U().data);A.push(y),L=y}return h(A)},[a,r,h,F]);return{size:F(),setSize:H,mutate:h,get data(){return d.data},get error(){return d.error},get isValidating(){return d.isValidating},get isLoading(){return d.isLoading}}},Ye=ke(Ke,Je),Ge=t=>(e,n)=>n&&!n.after?null:e===0?`${t}${t.includes("?")?"&":"?"}limit=25`:`${t}${t.includes("?")?"&":"?"}after=${n==null?void 0:n.after}&limit=25`;function nn(){var z,M;const t=re(),{mode:e,val:n}=t,{isIntersecting:i,ref:s}=oe({threshold:.9});E.useEffect(()=>{function d(h){h.state&&t.setVal(h.state.val)}return window.addEventListener("popstate",d),()=>{window.removeEventListener("popstate",d)}},[t]);const r=E.useRef(!1),f=ie[e].url,S=`https://www.reddit.com/${n.startsWith("/")?n.slice(1):n}${f??""}`,{data:u,size:C,setSize:w,error:R,isValidating:_,isLoading:a}=Ye(Ge(S),async d=>{const h=await fetch(d);if(!h.ok)throw new Error(`HTTP ${h.status} fetching ${d} ${await h.text()}`);return(await h.json()).data}),O=u==null?void 0:u.flatMap(d=>d.children).map(d=>d.data),p=a||C>0&&(u==null?void 0:u[C-1])===void 0,o=(((z=u==null?void 0:u[0])==null?void 0:z.children.length)??0)===0||(((M=u==null?void 0:u.at(-1))==null?void 0:M.children.length)??0)<25,F=_&&u&&u.length===C;return E.useEffect(()=>{i&&!r.current&&!a&&!F&&!o&&(r.current=!0,setTimeout(()=>{w(C+1).then(()=>{r.current=!1}).catch(d=>{console.error(d)})},400))},[i,w,C,o,F,a]),J.jsx("div",{children:a?J.jsx("div",{className:"flex justify-center",children:J.jsx(zt,{})}):R?J.jsx(ae,{error:R}):O?J.jsxs(J.Fragment,{children:[J.jsx(ce,{posts:O}),J.jsx("div",{ref:s,style:{height:400},className:"flex justify-center mt-10",children:p?J.jsx(zt,{}):o?"End of feed!":"Scroll all the way down to load more..."})]}):null})}export{nn as default};
//# sourceMappingURL=RedditPostFeed-v0bEVpfA.js.map
