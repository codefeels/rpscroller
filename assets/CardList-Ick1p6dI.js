const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./RedGifsCard-DJEs91kV.js","./index-Ihy08W7q.js","./index-_BCJLxBB.css","./index-CKdSAwxY.js","./util-BiULzenF.js","./GalleryCard-C4bBMuZi.js","./Button-CgCNXrVK.js","./index-Neg71-Qt.js","./index-tGctV_vJ.js","./Link-DWwhCNL0.js","./formatDistanceToNowStrict-DGPDrA_T.js","./en-US-Ckk-QizZ.js"])))=>i.map(i=>d[i]);
import{j as r,r as m,u as x,h as y,G as A,_ as N}from"./index-Ihy08W7q.js";import{M as p,a as O}from"./index-Neg71-Qt.js";import{F as P}from"./index-tGctV_vJ.js";import{B as u}from"./Button-CgCNXrVK.js";import{L as h}from"./Link-DWwhCNL0.js";import{d as $,a as R}from"./util-BiULzenF.js";import{f as z}from"./formatDistanceToNowStrict-DGPDrA_T.js";function pe(){return r.jsx("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",style:{width:100,height:100},viewBox:"0 0 24 24",children:r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})})}function be({error:e}){return r.jsxs("div",{className:"text-red-600 m-20",children:[r.jsx("div",{children:`${e}`}),r.jsxs("div",{children:[`${e}`=="TypeError: NetworkError when attempting to fetch resource."?"If you are on firefox then you can disable 'Enhanced Tracking Protection' (at your own risk) to fix this error":""," "]})]})}function G({title:e,url:t}){const[n,i]=m.useState(!1);return r.jsx("img",{alt:e,loading:"lazy",onClick:()=>{i(!n)},className:n?void 0:"w-full max-h-[80vh] object-contain",src:t})}const b=(e,t)=>t.some(n=>e instanceof n);let S,M;function K(){return S||(S=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function U(){return M||(M=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const B=new WeakMap,g=new WeakMap,j=new WeakMap;function H(e){const t=new Promise((n,i)=>{const c=()=>{e.removeEventListener("success",o),e.removeEventListener("error",a)},o=()=>{n(f(e.result)),c()},a=()=>{i(e.error),c()};e.addEventListener("success",o),e.addEventListener("error",a)});return j.set(t,e),t}function J(e){if(B.has(e))return;const t=new Promise((n,i)=>{const c=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",a),e.removeEventListener("abort",a)},o=()=>{n(),c()},a=()=>{i(e.error||new DOMException("AbortError","AbortError")),c()};e.addEventListener("complete",o),e.addEventListener("error",a),e.addEventListener("abort",a)});B.set(e,t)}let I={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return B.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function F(e){I=e(I)}function Q(e){return U().includes(e)?function(...t){return e.apply(C(this),t),f(this.request)}:function(...t){return f(e.apply(C(this),t))}}function X(e){return typeof e=="function"?Q(e):(e instanceof IDBTransaction&&J(e),b(e,K())?new Proxy(e,I):e)}function f(e){if(e instanceof IDBRequest)return H(e);if(g.has(e))return g.get(e);const t=X(e);return t!==e&&(g.set(e,t),j.set(t,e)),t}const C=e=>j.get(e);function Y(e,t,{blocked:n,upgrade:i,blocking:c,terminated:o}={}){const a=indexedDB.open(e,t),d=f(a);return i&&a.addEventListener("upgradeneeded",s=>{i(f(a.result),s.oldVersion,s.newVersion,f(a.transaction),s)}),n&&a.addEventListener("blocked",s=>n(s.oldVersion,s.newVersion,s)),d.then(s=>{o&&s.addEventListener("close",()=>o()),c&&s.addEventListener("versionchange",l=>c(l.oldVersion,l.newVersion,l))}).catch(()=>{}),d}const Z=["get","getKey","getAll","getAllKeys","count"],q=["put","add","delete","clear"],v=new Map;function W(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(v.get(t))return v.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,c=q.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(c||Z.includes(n)))return;const o=async function(a,...d){const s=this.transaction(a,c?"readwrite":"readonly");let l=s.store;return i&&(l=l.index(d.shift())),(await Promise.all([l[n](...d),c&&s.done]))[0]};return v.set(t,o),o}F(e=>({...e,get:(t,n,i)=>W(t,n)||e.get(t,n,i),has:(t,n)=>!!W(t,n)||e.has(t,n)}));const ee=["continue","continuePrimaryKey","advance"],_={},D=new WeakMap,T=new WeakMap,te={get(e,t){if(!ee.includes(t))return e[t];let n=_[t];return n||(n=_[t]=function(...i){D.set(this,T.get(this)[t](...i))}),n}};async function*ne(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,te);for(T.set(n,t),j.set(n,C(t));t;)yield n,t=await(D.get(n)||t.continue()),D.delete(n)}function L(e,t){return t===Symbol.asyncIterator&&b(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&b(e,[IDBIndex,IDBObjectStore])}F(e=>({...e,get(t,n,i){return L(t,n)?ne:e.get(t,n,i)},has(t,n){return L(t,n)||e.has(t,n)}}));const V=Y("test",2,{upgrade(e){e.createObjectStore("savedPosts")}});async function re(e){await(await V).put("savedPosts",e,e.id)}async function se(e){await(await V).delete("savedPosts",e.id)}function ie({post:e}){var E;const t=x(),{subreddit_name_prefixed:n,crosspost_parent_list:i}=e,{val:c}=t,o=((E=i==null?void 0:i[0])==null?void 0:E.subreddit_name_prefixed)??"",a=n,d=y(o,t.favorites),s=y(a,t.favorites),[l,k]=m.useState(!1);return r.jsxs("div",{children:[o?r.jsxs(r.Fragment,{children:[r.jsxs(u,{onClick:()=>{t.setVal(o)},children:["Browse ",o]}),d?null:r.jsxs(u,{onClick:()=>{t.addFavorite(o)},children:[r.jsx(p,{className:"inline"})," ",o]})]}):null,r.jsxs(u,{onClick:()=>{t.setVal(a)},children:["Browse ",a]}),s?null:r.jsxs(u,{onClick:()=>{t.addFavorite(a)},children:[r.jsx(p,{className:"inline"})," ",a]}),c==="savedposts"?r.jsxs(u,{onClick:()=>{(async()=>{try{await se(e),t.forceRerender()}catch(w){console.error(w)}})()},children:[r.jsx(P,{className:"inline"})," Remove from saved"]}):r.jsxs(u,{onClick:()=>{(async()=>{try{await re(e)}catch(w){console.error(w)}})(),k(!0),setTimeout(()=>{k(!1)},400)},children:[r.jsx(P,{className:"inline"})," ",l?"Saved!":"Save post"]})]})}function oe({post:e}){const t=x(),{author:n}=e,{favorites:i,blocked:c}=t,o=y(`/user/${n}`,i);return r.jsxs("div",{children:[r.jsxs(u,{onClick:()=>{t.setVal(`/user/${n}`)},children:["Browse ",`/u/${n}`]}),o?null:r.jsxs(u,{onClick:()=>{t.addFavorite(`/user/${n}`)},children:[r.jsx(p,{className:"inline"})," ",`/u/${n}`]}),o||c.includes(n)?null:r.jsxs(u,{onClick:()=>{t.setBlocked(n)},children:[r.jsx(O,{className:"inline"})," Block ",`/u/${n}`]})]})}function ae({post:e}){return r.jsxs("div",{children:[r.jsx(oe,{post:e}),r.jsx(ie,{post:e})]})}function ce(e){return A({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 14h4v7a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-7h4a1.001 1.001 0 0 0 .781-1.625l-8-10c-.381-.475-1.181-.475-1.562 0l-8 10A1.001 1.001 0 0 0 4 14z"},child:[]}]})(e)}function de({post:e}){const{hideButtons:t}=x(),{author:n,subreddit_name_prefixed:i,title:c,permalink:o,url:a}=e;return r.jsxs("div",{children:[r.jsxs("h4",{className:"inline",children:[$(c)," (",z(new Date(e.created*1e3),{addSuffix:!0}),") [",e.score," ",r.jsx(ce,{className:"inline"}),"]"]})," ","(",r.jsx(h,{href:`https://reddit.com/u/${n}`,target:"_blank",rel:"noreferrer",children:"user"}),") (",r.jsx(h,{href:a,target:"_blank",rel:"noreferrer",children:"url"}),") (",r.jsx(h,{href:`https://reddit.com/${i}`,target:"_blank",rel:"noreferrer",children:"subreddit"}),") (",r.jsx(h,{href:`https://reddit.com${o}`,target:"_blank",rel:"noreferrer",children:"comments"}),")",t?null:r.jsx(ae,{post:e})]})}const le=m.lazy(()=>N(()=>import("./RedGifsCard-DJEs91kV.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),ue=m.lazy(()=>N(()=>import("./GalleryCard-C4bBMuZi.js"),__vite__mapDeps([5,1,2,4,6,7,8,9,10,11]),import.meta.url));function fe(e){return!e.includes("redgifs")&&(e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".webp")||e.endsWith(".png")||e.endsWith(".gif")||e.endsWith(".webp"))}function he({post:e}){const{title:t,url:n}=e;return r.jsxs("div",{children:[r.jsx(de,{post:e}),n.startsWith("https://www.reddit.com/gallery")?r.jsx(ue,{post:e}):n.includes("redgifs")?r.jsx(le,{post:e}):fe(n)?r.jsx(G,{title:t,url:n}):r.jsxs("div",{children:["We do not know how to embed this post type yet!"," ",r.jsxs("a",{href:n,children:[n," ",t]})]})]})}function Be({posts:e}){const{noGifs:t,blocked:n,skipPinned:i,dedupe:c,fullscreen:o,redGifsOnly:a}=x();let d=e.filter(s=>!("comment_type"in s)).filter(({url:s})=>s.includes("redgifs")||s.endsWith(".jpg")||s.endsWith(".webp")||s.endsWith(".jpeg")||s.endsWith(".png")||s.endsWith(".gif")||s.endsWith(".webp")||s.startsWith("https://www.reddit.com/gallery")).filter(s=>t?!s.url.endsWith(".gif"):!0).filter(s=>a?s.url.includes("redgifs"):!0).filter(s=>i?!s.pinned:!0).filter(s=>!n.includes(s.author));return c&&(d=R(d,s=>s.url)),r.jsx("div",{className:"flex justify-center overflow-hidden",children:r.jsx("div",{className:o?"lg:w-11/12":"lg:w-1/2",children:r.jsx("div",{className:"flex flex-col space-y-20",children:d.length>0?d.map(s=>r.jsx(he,{post:s},s.id)):r.jsx("h1",{children:"No results on this page, check your filters in the settings or this may just have been a page of comments if you are browsing a user page"})})})})}export{Be as C,be as E,G as I,pe as L,V as d};
//# sourceMappingURL=CardList-Ick1p6dI.js.map
