const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SavedPostFeed-DWNwcapX.js","./index-Bisk0RAm.js","./index-COoidjXZ.css","./LoadingSpinner-BiSEUkaz.js","./BaseDialog-B4X8y4tI.js","./Link-DtBKRGOo.js","./formatDistanceToNowStrict-BGM-HUpS.js","./en-US-A-7Ux56e.js","./RedditPostFeed-BpXQfaku.js","./EditFeedDialog-4TKaeMKf.js"])))=>i.map(i=>d[i]);
import{u as D,a as ct,j as r,r as v,_ as We,G as $,L as we,M as yt,b as Ct,c as $e,d as fe,B as K,n as se,i as G,e as Ot,R as ze,S as _t}from"./index-Bisk0RAm.js";import{F as Dt,a as Lt,B as Vt}from"./BaseDialog-B4X8y4tI.js";const Tt=v.lazy(()=>We(()=>import("./SavedPostFeed-DWNwcapX.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),Ft=v.lazy(()=>We(()=>import("./RedditPostFeed-BpXQfaku.js"),__vite__mapDeps([8,1,2,3,4,5,6,7]),import.meta.url));function kn(){const{defaultPage:e}=D(),t=ct(e);return r.jsx(v.Suspense,{fallback:null,children:t==="savedposts"?r.jsx(Tt,{}):r.jsx(Ft,{})})}function Pn(e){return $({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(e)}function Hn(e){return $({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(e)}function It(e){return $({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function Wn(e){return $({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function lt(e){return $({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function ut(e){return $({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function Mt(e){return $({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(e)}function At(e){return $({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528.12 301.319l47.273-208C578.806 78.301 567.391 64 551.99 64H159.208l-9.166-44.81C147.758 8.021 137.93 0 126.529 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24h69.883l70.248 343.435C147.325 417.1 136 435.222 136 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-15.674-6.447-29.835-16.824-40h209.647C430.447 426.165 424 440.326 424 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-22.172-12.888-41.332-31.579-50.405l5.517-24.276c3.413-15.018-8.002-29.319-23.403-29.319H218.117l-6.545-32h293.145c11.206 0 20.92-7.754 23.403-18.681z"},child:[]}]})(e)}function Nt(e){return $({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function re({children:e,onClick:t}){return r.jsx("div",{className:"hover:bg-gray-300 dark:hover:bg-gray-600 cursor-pointer whitespace-nowrap",onClick:t,children:e})}function xe({children:e}){return r.jsx("div",{className:"border-b border-r-slate-600 pb-2 pt-2",children:e})}function kt(){const e=D();return r.jsxs(xe,{children:[r.jsx(we,{to:"/savedposts",children:r.jsxs(re,{children:[r.jsx(Mt,{className:"inline"})," Saved posts"]})}),r.jsxs(re,{onClick:()=>{e.setCurrentlyOpenDialog("multi")},children:[r.jsx(At,{className:"inline"})," Make list"]}),r.jsxs(re,{onClick:()=>{e.setCurrentlyOpenDialog("blocked")},children:[r.jsx(yt,{className:"inline"})," Blocked users"]}),r.jsxs(re,{onClick:()=>{e.setCurrentlyOpenDialog("about")},children:[r.jsx(Ct,{className:"inline"})," About"]})]})}function oe({label:e,localStorageKey:t,list:n}){const s=D(),i=$e(),[c,o]=fe(t,!0),[a,f]=fe("showMore-"+t,!0);return r.jsxs(xe,{children:[r.jsxs("div",{className:"flex gap-1",children:[e,":",r.jsx(K,{onClick:()=>{o(!c)},children:c?r.jsx(Dt,{className:"inline"}):r.jsx(Lt,{className:"inline"})}),r.jsx(K,{onClick:()=>{f(!a)},children:a?"Show less":"Show more"})]}),c?r.jsx("div",{children:n.length>0?n.slice(0,a?1e3:7).map(m=>r.jsx(we,{to:m.name,onClick:()=>{i&&s.setSidebarOpen(!1)},children:r.jsxs(re,{children:["- ",se(m.name),m.visitedCount?`(${m.visitedCount})`:""]})},m.name)):"No items"}):null]})}function Pt(){const e=D(),{favorites:t}=e;return r.jsx(oe,{label:"Favorite subreddits",localStorageKey:"favSubreddits",list:t.filter(n=>!G(n.name))})}function Ht(){const e=D(),{favorites:t}=e;return r.jsx(oe,{label:"Favorite users",localStorageKey:"favUsers",list:t.filter(n=>G(n.name))})}function Wt({children:e,onClick:t}){return r.jsx("span",{className:"hover:bg-gray-300 dark:hover:bg-gray-600 cursor-pointer m-1 whitespace-nowrap",onClick:t,children:e})}const $t=v.lazy(()=>We(()=>import("./EditFeedDialog-4TKaeMKf.js"),__vite__mapDeps([9,1,2,4]),import.meta.url));function zt({feed:e}){const t=D(),[n,s]=v.useState(!1);return r.jsxs("div",{children:[r.jsx(we,{to:`/r/${e.subreddits.join("+")}`,children:r.jsxs(Wt,{children:["- ",e.name]})}),r.jsx(K,{onClick:()=>{s(!0)},children:r.jsx(It,{})}),r.jsx(K,{onClick:()=>{t.removeFeed(e.name)},children:r.jsx(Nt,{})}),n?r.jsx(v.Suspense,{fallback:null,children:r.jsx($t,{onClose:()=>{s(!1)},feed:e})}):null]})}function Bt(){const e=D(),{feeds:t}=e,[n,s]=fe("showFeeds",!0);return t.length>0?r.jsxs(xe,{children:[r.jsxs("div",{children:["Feeds:"," ",r.jsx(K,{onClick:()=>{s(!n)},children:n?r.jsx(lt,{className:"inline"}):r.jsx(ut,{className:"inline"})})]}),n?t.map(i=>r.jsx(zt,{feed:i},i.name)):null]}):null}function Ut(){const e=D(),{recentlyVisited:t}=e,n=new Set(e.feeds.map(s=>`r/${s.subreddits.join("+")}`));return r.jsx(oe,{list:t.filter(s=>!G(s.name)).toSorted((s,i)=>i.visitedCount-s.visitedCount).filter(s=>!n.has(s.name)),label:"Most visited subreddits",localStorageKey:"mostVisitedSubreddits"})}function qt(){const e=D(),{recentlyVisited:t}=e,n=new Set(e.feeds.map(s=>`r/${s.subreddits.join("+")}`));return r.jsx(oe,{list:t.filter(s=>G(s.name)).toSorted((s,i)=>i.visitedCount-s.visitedCount).filter(s=>!n.has(s.name)),label:"Most visited users",localStorageKey:"mostVisitedUsers"})}function Kt(){const e=D(),{recentlyVisited:t}=e,n=new Set(e.feeds.map(s=>`r/${s.subreddits.join("+")}`));return r.jsx(oe,{label:"Recently visited subreddits",localStorageKey:"recentlyVisitedSubreddits",list:t.filter(s=>!G(s.name)).toSorted((s,i)=>+i.lastVisited-+s.lastVisited).filter(s=>!n.has(s.name))})}function Gt(){const e=D(),{recentlyVisited:t}=e,n=new Set(e.feeds.map(s=>`r/${s.subreddits.join("+")}`));return r.jsx(oe,{label:"Recently visited users",localStorageKey:"recentlyVisitedUsers",list:t.filter(s=>G(s.name)).toSorted((s,i)=>+i.lastVisited-+s.lastVisited).filter(s=>!n.has(s.name))})}var ye={exports:{}},Ce={};var Ze;function Jt(){if(Ze)return Ce;Ze=1;var e=Ot();function t(d,l){return d===l&&(d!==0||1/d===1/l)||d!==d&&l!==l}var n=typeof Object.is=="function"?Object.is:t,s=e.useState,i=e.useEffect,c=e.useLayoutEffect,o=e.useDebugValue;function a(d,l){var S=l(),y=s({inst:{value:S,getSnapshot:l}}),j=y[0].inst,_=y[1];return c(function(){j.value=S,j.getSnapshot=l,f(j)&&_({inst:j})},[d,S,l]),i(function(){return f(j)&&_({inst:j}),d(function(){f(j)&&_({inst:j})})},[d]),o(S),S}function f(d){var l=d.getSnapshot;d=d.value;try{var S=l();return!n(d,S)}catch{return!0}}function m(d,l){return l()}var g=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?m:a;return Ce.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:g,Ce}var et;function Yt(){return et||(et=1,ye.exports=Jt()),ye.exports}var tt=Yt();const dt=0,ft=1,ht=2,nt=3;var st=Object.prototype.hasOwnProperty;function Fe(e,t){var n,s;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((s=e.length)===t.length)for(;s--&&Fe(e[s],t[s]););return s===-1}if(!n||typeof e=="object"){s=0;for(n in e)if(st.call(e,n)&&++s&&!st.call(t,n)||!(n in t)||!Fe(e[n],t[n]))return!1;return Object.keys(t).length===s}}return e!==e&&t!==t}const H=new WeakMap,W=()=>{},O=W(),Ie=Object,h=e=>e===O,k=e=>typeof e=="function",z=(e,t)=>({...e,...t}),mt=e=>k(e.then),Oe={},ve={},Be="undefined",he=typeof window!=Be,Me=typeof document!=Be,Xt=he&&"Deno"in window,Qt=()=>he&&typeof window.requestAnimationFrame!=Be,St=(e,t)=>{const n=H.get(e);return[()=>!h(t)&&e.get(t)||Oe,s=>{if(!h(t)){const i=e.get(t);t in ve||(ve[t]=i),n[5](t,z(i,s),i||Oe)}},n[6],()=>!h(t)&&t in ve?ve[t]:!h(t)&&e.get(t)||Oe]};let Ae=!0;const Zt=()=>Ae,[Ne,ke]=he&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[W,W],en=()=>{const e=Me&&document.visibilityState;return h(e)||e!=="hidden"},tn=e=>(Me&&document.addEventListener("visibilitychange",e),Ne("focus",e),()=>{Me&&document.removeEventListener("visibilitychange",e),ke("focus",e)}),nn=e=>{const t=()=>{Ae=!0,e()},n=()=>{Ae=!1};return Ne("online",t),Ne("offline",n),()=>{ke("online",t),ke("offline",n)}},sn={isOnline:Zt,isVisible:en},rn={initFocus:tn,initReconnect:nn},rt=!ze.useId,ie=!he||Xt,on=e=>Qt()?window.requestAnimationFrame(e):setTimeout(e,1),_e=ie?v.useEffect:v.useLayoutEffect,De=typeof navigator<"u"&&navigator.connection,it=!ie&&De&&(["slow-2g","2g"].includes(De.effectiveType)||De.saveData),ge=new WeakMap,an=e=>Ie.prototype.toString.call(e),Le=(e,t)=>e===`[object ${t}]`;let cn=0;const Pe=e=>{const t=typeof e,n=an(e),s=Le(n,"Date"),i=Le(n,"RegExp"),c=Le(n,"Object");let o,a;if(Ie(e)===e&&!s&&!i){if(o=ge.get(e),o)return o;if(o=++cn+"~",ge.set(e,o),Array.isArray(e)){for(o="@",a=0;a<e.length;a++)o+=Pe(e[a])+",";ge.set(e,o)}if(c){o="#";const f=Ie.keys(e).sort();for(;!h(a=f.pop());)h(e[a])||(o+=a+":"+Pe(e[a])+",");ge.set(e,o)}}else o=s?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return o},Ue=e=>{if(k(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?Pe(e):"",[e,t]};let ln=0;const He=()=>++ln;async function pt(...e){const[t,n,s,i]=e,c=z({populateCache:!0,throwOnError:!0},typeof i=="boolean"?{revalidate:i}:i||{});let o=c.populateCache;const a=c.rollbackOnError;let f=c.optimisticData;const m=l=>typeof a=="function"?a(l):a!==!1,g=c.throwOnError;if(k(n)){const l=n,S=[],y=t.keys();for(const j of y)!/^\$(inf|sub)\$/.test(j)&&l(t.get(j)._k)&&S.push(j);return Promise.all(S.map(d))}return d(n);async function d(l){const[S]=Ue(l);if(!S)return;const[y,j]=St(t,S),[_,ae,u,me]=H.get(t),J=()=>{const T=_[S];return(k(c.revalidate)?c.revalidate(y().data,l):c.revalidate!==!1)&&(delete u[S],delete me[S],T&&T[0])?T[0](ht).then(()=>y().data):y().data};if(e.length<3)return J();let C=s,I,M=!1;const Y=He();ae[S]=[Y,0];const w=!h(f),X=y(),A=X.data,Q=X._c,B=h(Q)?A:Q;if(w&&(f=k(f)?f(B,A):f,j({data:f,_c:B})),k(C))try{C=C(B)}catch(T){I=T,M=!0}if(C&&mt(C))if(C=await C.catch(T=>{I=T,M=!0}),Y!==ae[S][0]){if(M)throw I;return C}else M&&w&&m(I)&&(o=!0,j({data:B,_c:O}));if(o&&!M)if(k(o)){const T=o(C,B);j({data:T,error:O,_c:O})}else j({data:C,error:O,_c:O});if(ae[S][1]=He(),Promise.resolve(J()).then(()=>{j({_c:O})}),M){if(g)throw I;return}return C}}const ot=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},un=(e,t)=>{if(!H.has(e)){const n=z(rn,t),s=Object.create(null),i=pt.bind(O,e);let c=W;const o=Object.create(null),a=(g,d)=>{const l=o[g]||[];return o[g]=l,l.push(d),()=>l.splice(l.indexOf(d),1)},f=(g,d,l)=>{e.set(g,d);const S=o[g];if(S)for(const y of S)y(d,l)},m=()=>{if(!H.has(e)&&(H.set(e,[s,Object.create(null),Object.create(null),Object.create(null),i,f,a]),!ie)){const g=n.initFocus(setTimeout.bind(O,ot.bind(O,s,dt))),d=n.initReconnect(setTimeout.bind(O,ot.bind(O,s,ft)));c=()=>{g&&g(),d&&d(),H.delete(e)}}};return m(),[e,i,m,c]}return[e,H.get(e)[4]]},dn=(e,t,n,s,i)=>{const c=n.errorRetryCount,o=i.retryCount,a=~~((Math.random()+.5)*(1<<(o<8?o:8)))*n.errorRetryInterval;!h(c)&&o>c||setTimeout(s,a,i)},fn=Fe,[vt,hn]=un(new Map),mn=z({onLoadingSlow:W,onSuccess:W,onError:W,onErrorRetry:dn,onDiscarded:W,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:it?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:it?5e3:3e3,compare:fn,isPaused:()=>!1,cache:vt,mutate:hn,fallback:{}},sn),Sn=(e,t)=>{const n=z(e,t);if(t){const{use:s,fallback:i}=e,{use:c,fallback:o}=t;s&&c&&(n.use=s.concat(c)),i&&o&&(n.fallback=z(i,o))}return n},pn=v.createContext({}),vn="$inf$",gt=he&&window.__SWR_DEVTOOLS_USE__,gn=gt?window.__SWR_DEVTOOLS_USE__:[],wn=()=>{gt&&(window.__SWR_DEVTOOLS_REACT__=ze)},wt=e=>k(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],xn=()=>{const e=v.useContext(pn);return v.useMemo(()=>z(mn,e),[e])},bn=e=>(t,n,s)=>e(t,n&&((...c)=>{const[o]=Ue(t),[,,,a]=H.get(vt);if(o.startsWith(vn))return n(...c);const f=a[o];return h(f)?n(...c):(delete a[o],f)}),s),En=gn.concat(bn),jn=e=>function(...n){const s=xn(),[i,c,o]=wt(n),a=Sn(s,o);let f=e;const{use:m}=a,g=(m||[]).concat(En);for(let d=g.length;d--;)f=g[d](f);return f(i,c||a.fetcher||null,a)},Rn=(e,t,n)=>{const s=t[e]||(t[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i>=0&&(s[i]=s[s.length-1],s.pop())}},$n=(e,t)=>(...n)=>{const[s,i,c]=wt(n),o=(c.use||[]).concat(t);return e(s,i,{...c,use:o})};wn();const Ve=ze.use||(e=>{switch(e.status){case"pending":throw e;case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e}}),Te={dedupe:!0},at=Promise.resolve(O),yn=()=>W,Cn=(e,t,n)=>{const{cache:s,compare:i,suspense:c,fallbackData:o,revalidateOnMount:a,revalidateIfStale:f,refreshInterval:m,refreshWhenHidden:g,refreshWhenOffline:d,keepPreviousData:l,strictServerPrefetchWarning:S}=n,[y,j,_,ae]=H.get(s),[u,me]=Ue(e),J=v.useRef(!1),C=v.useRef(!1),I=v.useRef(u),M=v.useRef(t),Y=v.useRef(n),w=()=>Y.current,X=()=>w().isVisible()&&w().isOnline(),[A,Q,B,T]=St(s,u),Z=v.useRef({}).current,ee=h(o)?h(n.fallback)?O:n.fallback[u]:o,Ke=(p,x)=>{for(const b in Z){const E=b;if(E==="data"){if(!i(p[E],x[E])&&(!h(p[E])||!i(pe,x[E])))return!1}else if(x[E]!==p[E])return!1}return!0},Ge=!J.current,Je=v.useMemo(()=>{const p=A(),x=T(),b=R=>{const F=z(R);return delete F._k,(()=>{if(!u||!t||w().isPaused())return!1;if(Ge&&!h(a))return a;const de=h(ee)?F.data:ee;return h(de)||f})()?{isValidating:!0,isLoading:!0,...F}:F},E=b(p),N=p===x?E:b(x);let L=E;return[()=>{const R=b(A());return Ke(R,L)?(L.data=R.data,L.isLoading=R.isLoading,L.isValidating=R.isValidating,L.error=R.error,L):(L=R,R)},()=>N]},[s,u]),te=tt.useSyncExternalStore(v.useCallback(p=>B(u,(x,b)=>{Ke(b,x)||p()}),[s,u]),Je[0],Je[1]),xt=y[u]&&y[u].length>0,ne=te.data,U=h(ne)?ee&&mt(ee)?Ve(ee):ee:ne,Se=te.error,be=v.useRef(U),pe=l?h(ne)?h(be.current)?U:be.current:ne:U,q=u&&h(U),ce=v.useRef(null);!ie&&tt.useSyncExternalStore(yn,()=>(ce.current=!1,ce),()=>(ce.current=!0,ce));const bt=ce.current;S&&bt&&!c&&q&&console.warn(`Missing pre-initiated data for serialized key "${u}" during server-side rendering. Data fetching should be initiated on the server and provided to SWR via fallback data. You can set "strictServerPrefetchWarning: false" to disable this warning.`);const Ee=!u||!t||w().isPaused()||xt&&!h(Se)?!1:Ge&&!h(a)?a:c?h(U)?!1:f:h(U)||f,Et=h(te.isValidating)?Ee:te.isValidating,jt=h(te.isLoading)?Ee:te.isLoading,le=v.useCallback(async p=>{const x=M.current;if(!u||!x||C.current||w().isPaused())return!1;let b,E,N=!0;const L=p||{},R=!_[u]||!L.dedupe,F=()=>rt?!C.current&&u===I.current&&J.current:u===I.current,ue={isValidating:!1,isLoading:!1},de=()=>{Q(ue)},Xe=()=>{const V=_[u];V&&V[1]===E&&delete _[u]},Qe={isValidating:!0};h(A().data)&&(Qe.isLoading=!0);try{if(R&&(Q(Qe),n.loadingTimeout&&h(A().data)&&setTimeout(()=>{N&&F()&&w().onLoadingSlow(u,n)},n.loadingTimeout),_[u]=[x(me),He()]),[b,E]=_[u],b=await b,R&&setTimeout(Xe,n.dedupingInterval),!_[u]||_[u][1]!==E)return R&&F()&&w().onDiscarded(u),!1;ue.error=O;const V=j[u];if(!h(V)&&(E<=V[0]||E<=V[1]||V[1]===0))return de(),R&&F()&&w().onDiscarded(u),!1;const P=A().data;ue.data=i(P,b)?P:b,R&&F()&&w().onSuccess(b,u,n)}catch(V){Xe();const P=w(),{shouldRetryOnError:je}=P;P.isPaused()||(ue.error=V,R&&F()&&(P.onError(V,u,P),(je===!0||k(je)&&je(V))&&(!w().revalidateOnFocus||!w().revalidateOnReconnect||X())&&P.onErrorRetry(V,u,P,Rt=>{const Re=y[u];Re&&Re[0]&&Re[0](nt,Rt)},{retryCount:(L.retryCount||0)+1,dedupe:!0})))}return N=!1,de(),!0},[u,s]),Ye=v.useCallback((...p)=>pt(s,I.current,...p),[]);if(_e(()=>{M.current=t,Y.current=n,h(ne)||(be.current=ne)}),_e(()=>{if(!u)return;const p=le.bind(O,Te);let x=0;w().revalidateOnFocus&&(x=Date.now()+w().focusThrottleInterval);const E=Rn(u,y,(N,L={})=>{if(N==dt){const R=Date.now();w().revalidateOnFocus&&R>x&&X()&&(x=R+w().focusThrottleInterval,p())}else if(N==ft)w().revalidateOnReconnect&&X()&&p();else{if(N==ht)return le();if(N==nt)return le(L)}});return C.current=!1,I.current=u,J.current=!0,Q({_k:me}),Ee&&(_[u]||(h(U)||ie?p():on(p))),()=>{C.current=!0,E()}},[u]),_e(()=>{let p;function x(){const E=k(m)?m(A().data):m;E&&p!==-1&&(p=setTimeout(b,E))}function b(){!A().error&&(g||w().isVisible())&&(d||w().isOnline())?le(Te).then(x):x()}return x(),()=>{p&&(clearTimeout(p),p=-1)}},[m,g,d,u]),v.useDebugValue(pe),c){if(!rt&&ie&&q)throw new Error("Fallback data is required when using Suspense in SSR.");q&&(M.current=t,Y.current=n,C.current=!1);const p=ae[u],x=!h(p)&&q?Ye(p):at;if(Ve(x),!h(Se)&&q)throw Se;const b=q?le(Te):at;!h(pe)&&q&&(b.status="fulfilled",b.value=!0),Ve(b)}return{mutate:Ye,get data(){return Z.data=!0,pe},get error(){return Z.error=!0,Se},get isValidating(){return Z.isValidating=!0,Et},get isLoading(){return Z.isLoading=!0,jt}}},On=jn(Cn);async function qe(e){const t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status} fetching ${e}: ${await t.text()}`);return t}async function _n(e){return(await qe(e)).text()}async function Dn(e){return(await qe(e)).arrayBuffer()}async function zn(e){return(await qe(e)).json()}async function Ln(){const t=(await _n("node-ids.txt")).split(`
`);let n;const s=await Dn("links.bin"),i=new DataView(s),c=[];for(let a=0;a<i.byteLength;a+=4){const f=i.getInt32(a,!0);if(f<0)n=-f-1;else{const m=f-1;c.push([t[n],t[m]])}}const o={};for(let a=0,f=c.length;a<f;a++){const[m,g]=c[a];o[m]??=[],o[m].push(g)}return o}function Vn(){const e=D(),{defaultPage:t,recentlyVisited:n}=e,s=ct(t),{data:i,isLoading:c,error:o}=On("graph",()=>Ln(),{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1}),[a,f]=fe("showSimilar",!0),[m,g]=fe("showMoreSimilar",!0),d=Object.fromEntries(n.map(l=>[l.name,l]));return G(s)?null:r.jsxs(xe,{children:[r.jsxs("div",{children:["Similar subreddits:",r.jsx(K,{onClick:()=>{f(!a)},children:a?r.jsx(lt,{className:"inline"}):r.jsx(ut,{className:"inline"})}),r.jsx(K,{className:"ml-1",onClick:()=>{g(!m)},children:m?"Show less":"Show more"})]}),a?r.jsxs("div",{children:[c?r.jsx("div",{children:"Loading"}):null,o?r.jsx("div",{className:"text-error",children:`${o}`}):null,i?r.jsx("div",{children:[...new Set(i[se(s).replace("r/","")])].map(l=>`/r/${l}`).toSorted((l,S)=>((d[se(l)]?.visitedCount??0)-(d[se(S)]?.visitedCount??0))*-1).slice(0,m?1e3:7).map(l=>r.jsx(we,{to:l,children:r.jsxs(re,{children:["- ",se(l)," (",d[se(l)]?.visitedCount??0,")"]})},l))}):null]}):null]})}function Tn({children:e}){return r.jsx("div",{className:"mt-3 mb-20",children:e})}function Fn({children:e}){const t=D();return r.jsx(Vt,{open:!0,onClose:()=>{t.setSidebarOpen(!1)},children:r.jsx("div",{className:"w-screen h-screen",children:e})})}function In({children:e}){return $e()?r.jsx(Fn,{children:e}):r.jsx(Tn,{children:e})}function Bn(){const e=$e();return r.jsxs(In,{children:[e?r.jsx(_t,{}):null,r.jsx(Vn,{}),r.jsx(Ut,{}),r.jsx(qt,{}),r.jsx(Kt,{}),r.jsx(Gt,{}),r.jsx(Pt,{}),r.jsx(Ht,{}),r.jsx(Bt,{}),r.jsx(kt,{})]})}export{kn as F,vn as I,Bn as S,O as U,H as a,St as b,vt as c,_e as d,Ue as e,k as f,Wn as g,Mt as h,h as i,Pn as j,Hn as k,zn as m,tt as s,On as u,$n as w};
//# sourceMappingURL=Sidebar-DhqwjClm.js.map
