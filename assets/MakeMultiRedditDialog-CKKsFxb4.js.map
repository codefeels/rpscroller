{"version":3,"file":"MakeMultiRedditDialog-CKKsFxb4.js","sources":["../../src/MakeMultiRedditDialog.tsx"],"sourcesContent":["import { useState } from 'react'\n\nimport { formatDistanceToNowStrict } from 'date-fns'\nimport { FaChevronDown, FaChevronUp } from 'react-icons/fa6'\n\nimport BaseDialog from './BaseDialog'\nimport Button from './Button'\nimport { useAppStore } from './store'\nimport {\n  isUserSubreddit,\n  normalizeForDisplay,\n  normalizeSubreddit,\n} from './util'\n\nexport default function MakeMultiRedditDialog({\n  open,\n  onClose,\n}: {\n  open: boolean\n  onClose: () => void\n}) {\n  const store = useAppStore()\n  const { recentlyVisited, favorites } = store\n  const [multi, setMulti] = useState<string[]>([])\n  const [sortVisits, setSortVisits] = useState(-1)\n  const [sortDateAdded, setSortDateAdded] = useState(0)\n  const [feedName, setFeedName] = useState('')\n  const [creatingFeed, setCreatingFeed] = useState(true)\n  const ret = Object.fromEntries(recentlyVisited.map(r => [r.name, r]))\n\n  const favs = [\n    ...favorites\n      .filter(f => !isUserSubreddit(f.name))\n      .sort((a, b) => a.name.toLowerCase().localeCompare(b.name.toLowerCase())),\n    ...favorites\n      .filter(f => isUserSubreddit(f.name))\n      .sort((a, b) => a.name.toLowerCase().localeCompare(b.name.toLowerCase())),\n  ]\n    .map(f => ({\n      ...f,\n      dateAdded: new Date(ret[f.name]?.dateAdded ?? new Date()),\n    }))\n    .sort(\n      (a, b) =>\n        ((ret[a.name]?.visitedCount ?? 0) - (ret[b.name]?.visitedCount ?? 0)) *\n        sortVisits,\n    )\n    .sort((a, b) => (+a.dateAdded - +b.dateAdded) * sortDateAdded)\n  return (\n    <BaseDialog open={open} onClose={onClose}>\n      {creatingFeed ? (\n        <div>\n          <h4>Make multi-reddit</h4>\n          <div>\n            <div>Current feed: {multi.join(', ')}</div>\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={() => {\n                  setCreatingFeed(false)\n                }}\n              >\n                Create feed\n              </Button>\n              <Button\n                onClick={() => {\n                  setMulti([])\n                }}\n              >\n                Clear\n              </Button>\n            </div>\n          </div>\n\n          <div className=\"max-h-[80vh] overflow-auto\">\n            <table>\n              <thead>\n                <tr>\n                  <th>Name</th>\n                  <th className=\"whitespace-nowrap\">\n                    <Button\n                      onClick={() => {\n                        setSortDateAdded(0)\n                        if (sortVisits === 0) {\n                          setSortVisits(-1)\n                        } else if (sortVisits === -1) {\n                          setSortVisits(1)\n                        } else {\n                          setSortVisits(0)\n                        }\n                      }}\n                    >\n                      # Visits{' '}\n                      {sortVisits === 1 ? (\n                        <FaChevronUp className=\"inline\" />\n                      ) : sortVisits === -1 ? (\n                        <FaChevronDown className=\"inline\" />\n                      ) : null}\n                    </Button>\n                  </th>\n                  <th className=\"whitespace-nowrap\">\n                    <Button\n                      onClick={() => {\n                        setSortVisits(0)\n                        if (sortDateAdded === 0) {\n                          setSortDateAdded(-1)\n                        } else if (sortDateAdded === -1) {\n                          setSortDateAdded(1)\n                        } else {\n                          setSortDateAdded(0)\n                        }\n                      }}\n                    >\n                      Date added{' '}\n                      {sortDateAdded === 1 ? (\n                        <FaChevronUp className=\"inline\" />\n                      ) : sortDateAdded === -1 ? (\n                        <FaChevronDown className=\"inline\" />\n                      ) : null}\n                    </Button>\n                  </th>\n                </tr>\n              </thead>\n              <tbody>\n                {favs.map(f => (\n                  <tr key={f.name}>\n                    <td className=\"whitespace-nowrap\">\n                      <Button\n                        onClick={() => {\n                          if (!multi.includes(normalizeSubreddit(f.name))) {\n                            setMulti([...multi, normalizeSubreddit(f.name)])\n                          }\n                        }}\n                      >\n                        {normalizeForDisplay(f.name)}\n                      </Button>\n                    </td>\n                    <td>{ret[f.name]?.visitedCount}</td>\n                    <td>\n                      {formatDistanceToNowStrict(f.dateAdded, {\n                        addSuffix: true,\n                      })}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      ) : (\n        <div className=\"m-8\">\n          <form\n            onSubmit={event => {\n              event.preventDefault()\n              if (feedName) {\n                store.createFeed({ subreddits: multi, feedName })\n                onClose()\n              }\n            }}\n          >\n            <div>\n              <label htmlFor=\"feedname\">Feed name:</label>\n              <input\n                id=\"feedname\"\n                type=\"text\"\n                className=\"input\"\n                value={feedName}\n                onChange={event => {\n                  setFeedName(event.target.value)\n                }}\n              />\n              <Button type=\"submit\">Submit</Button>\n            </div>\n          </form>\n        </div>\n      )}\n    </BaseDialog>\n  )\n}\n"],"names":["MakeMultiRedditDialog","open","onClose","store","useAppStore","recentlyVisited","favorites","multi","setMulti","useState","sortVisits","setSortVisits","sortDateAdded","setSortDateAdded","feedName","setFeedName","creatingFeed","setCreatingFeed","ret","r","favs","f","isUserSubreddit","a","b","BaseDialog","jsx","jsxs","Button","FaChevronUp","FaChevronDown","normalizeSubreddit","normalizeForDisplay","formatDistanceToNowStrict","event"],"mappings":"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"}