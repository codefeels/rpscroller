import{r as he,R as $t,a as g,u as pe,b as Ee,m as me,j as H,B as Re}from"./index-BouEHfai.js";import{L as Bt,E as Se,C as ge}from"./LoadingSpinner-BetHjGX8.js";import"./Link-CqG4CEnv.js";import"./formatDistanceToNowStrict-BYAa6EDh.js";import"./en-US-haJ8O9Oa.js";var gt={exports:{}},vt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jt;function ve(){if(Jt)return vt;Jt=1;var t=he();function e(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,u=t.useEffect,s=t.useLayoutEffect,i=t.useDebugValue;function m(c,h){var o=h(),y=r({inst:{value:o,getSnapshot:h}}),p=y[0].inst,B=y[1];return s(function(){p.value=o,p.getSnapshot=h,l(p)&&B({inst:p})},[c,o,h]),u(function(){return l(p)&&B({inst:p}),c(function(){l(p)&&B({inst:p})})},[c]),i(o),o}function l(c){var h=c.getSnapshot;c=c.value;try{var o=h();return!n(c,o)}catch{return!0}}function _(c,h){return h()}var O=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_:m;return vt.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:O,vt}var Kt;function we(){return Kt||(Kt=1,gt.exports=ve()),gt.exports}var ee=we();const ne=0,se=1,re=2,Gt=3;var Yt=Object.prototype.hasOwnProperty;function Tt(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&Tt(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(Yt.call(t,n)&&++r&&!Yt.call(e,n)||!(n in e)||!Tt(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}const K=new WeakMap,Z=()=>{},b=Z(),At=Object,d=t=>t===b,k=t=>typeof t=="function",tt=(t,e)=>({...t,...e}),ie=t=>k(t.then),wt={},dt={},Mt="undefined",lt=typeof window!=Mt,Lt=typeof document!=Mt,Oe=lt&&"Deno"in window,ye=()=>lt&&typeof window.requestAnimationFrame!=Mt,Q=(t,e)=>{const n=K.get(t);return[()=>!d(e)&&t.get(e)||wt,r=>{if(!d(e)){const u=t.get(e);e in dt||(dt[e]=u),n[5](e,tt(u,r),u||wt)}},n[6],()=>!d(e)&&e in dt?dt[e]:!d(e)&&t.get(e)||wt]};let xt=!0;const _e=()=>xt,[It,jt]=lt&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[Z,Z],Ce=()=>{const t=Lt&&document.visibilityState;return d(t)||t!=="hidden"},be=t=>(Lt&&document.addEventListener("visibilitychange",t),It("focus",t),()=>{Lt&&document.removeEventListener("visibilitychange",t),jt("focus",t)}),De=t=>{const e=()=>{xt=!0,t()},n=()=>{xt=!1};return It("online",e),It("offline",n),()=>{jt("online",e),jt("offline",n)}},Te={isOnline:_e,isVisible:Ce},Ae={initFocus:be,initReconnect:De},Xt=!$t.useId,ct=!lt||Oe,Le=t=>ye()?window.requestAnimationFrame(t):setTimeout(t,1),Et=ct?g.useEffect:g.useLayoutEffect,Ot=typeof navigator<"u"&&navigator.connection,Qt=!ct&&Ot&&(["slow-2g","2g"].includes(Ot.effectiveType)||Ot.saveData),ht=new WeakMap,yt=(t,e)=>At.prototype.toString.call(t)===`[object ${e}]`;let xe=0;const Vt=t=>{const e=typeof t,n=yt(t,"Date"),r=yt(t,"RegExp"),u=yt(t,"Object");let s,i;if(At(t)===t&&!n&&!r){if(s=ht.get(t),s)return s;if(s=++xe+"~",ht.set(t,s),Array.isArray(t)){for(s="@",i=0;i<t.length;i++)s+=Vt(t[i])+",";ht.set(t,s)}if(u){s="#";const m=At.keys(t).sort();for(;!d(i=m.pop());)d(t[i])||(s+=i+":"+Vt(t[i])+",");ht.set(t,s)}}else s=n?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},ut=t=>{if(k(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Vt(t):"",[t,e]};let Ie=0;const Pt=()=>++Ie;async function oe(...t){const[e,n,r,u]=t,s=tt({populateCache:!0,throwOnError:!0},typeof u=="boolean"?{revalidate:u}:u||{});let i=s.populateCache;const m=s.rollbackOnError;let l=s.optimisticData;const _=h=>typeof m=="function"?m(h):m!==!1,O=s.throwOnError;if(k(n)){const h=n,o=[],y=e.keys();for(const p of y)!/^\$(inf|sub)\$/.test(p)&&h(e.get(p)._k)&&o.push(p);return Promise.all(o.map(c))}return c(n);async function c(h){const[o]=ut(h);if(!o)return;const[y,p]=Q(e,o),[B,a,F,q]=K.get(e),$=()=>{const I=B[o];return(k(s.revalidate)?s.revalidate(y().data,h):s.revalidate!==!1)&&(delete F[o],delete q[o],I&&I[0])?I[0](re).then(()=>y().data):y().data};if(t.length<3)return $();let R=r,E;const L=Pt();a[o]=[L,0];const f=!d(l),N=y(),v=N.data,x=N._c,z=d(x)?v:x;if(f&&(l=k(l)?l(z,v):l,p({data:l,_c:z})),k(R))try{R=R(z)}catch(I){E=I}if(R&&ie(R))if(R=await R.catch(I=>{E=I}),L!==a[o][0]){if(E)throw E;return R}else E&&f&&_(E)&&(i=!0,p({data:z,_c:b}));if(i&&!E)if(k(i)){const I=i(R,z);p({data:I,error:b,_c:b})}else p({data:R,error:b,_c:b});if(a[o][1]=Pt(),Promise.resolve($()).then(()=>{p({_c:b})}),E){if(O)throw E;return}return R}}const Zt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},je=(t,e)=>{if(!K.has(t)){const n=tt(Ae,e),r=Object.create(null),u=oe.bind(b,t);let s=Z;const i=Object.create(null),m=(O,c)=>{const h=i[O]||[];return i[O]=h,h.push(c),()=>h.splice(h.indexOf(c),1)},l=(O,c,h)=>{t.set(O,c);const o=i[O];if(o)for(const y of o)y(c,h)},_=()=>{if(!K.has(t)&&(K.set(t,[r,Object.create(null),Object.create(null),Object.create(null),u,l,m]),!ct)){const O=n.initFocus(setTimeout.bind(b,Zt.bind(b,r,ne))),c=n.initReconnect(setTimeout.bind(b,Zt.bind(b,r,se)));s=()=>{O&&O(),c&&c(),K.delete(t)}}};return _(),[t,u,_,s]}return[t,K.get(t)[4]]},Ve=(t,e,n,r,u)=>{const s=n.errorRetryCount,i=u.retryCount,m=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!d(s)&&i>s||setTimeout(r,m,u)},Pe=Tt,[Wt,Fe]=je(new Map),Ne=tt({onLoadingSlow:Z,onSuccess:Z,onError:Z,onErrorRetry:Ve,onDiscarded:Z,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Qt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Qt?5e3:3e3,compare:Pe,isPaused:()=>!1,cache:Wt,mutate:Fe,fallback:{}},Te),$e=(t,e)=>{const n=tt(t,e);if(e){const{use:r,fallback:u}=t,{use:s,fallback:i}=e;r&&s&&(n.use=r.concat(s)),u&&i&&(n.fallback=tt(u,i))}return n},Me=g.createContext({}),ae="$inf$",ce=lt&&window.__SWR_DEVTOOLS_USE__,We=ce?window.__SWR_DEVTOOLS_USE__:[],qe=()=>{ce&&(window.__SWR_DEVTOOLS_REACT__=$t)},ue=t=>k(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],ze=()=>tt(Ne,g.useContext(Me)),Ue=t=>(e,n,r)=>t(e,n&&((...s)=>{const[i]=ut(e),[,,,m]=K.get(Wt);if(i.startsWith(ae))return n(...s);const l=m[i];return d(l)?n(...s):(delete m[i],l)}),r),He=We.concat(Ue),ke=t=>function(...n){const r=ze(),[u,s,i]=ue(n),m=$e(r,i);let l=t;const{use:_}=m,O=(_||[]).concat(He);for(let c=O.length;c--;)l=O[c](l);return l(u,s||m.fetcher||null,m)},Be=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const u=r.indexOf(n);u>=0&&(r[u]=r[r.length-1],r.pop())}},Je=(t,e)=>(...n)=>{const[r,u,s]=ue(n),i=(s.use||[]).concat(e);return t(r,u,{...s,use:i})};qe();const _t=$t.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),Ct={dedupe:!0},Ke=(t,e,n)=>{const{cache:r,compare:u,suspense:s,fallbackData:i,revalidateOnMount:m,revalidateIfStale:l,refreshInterval:_,refreshWhenHidden:O,refreshWhenOffline:c,keepPreviousData:h}=n,[o,y,p,B]=K.get(r),[a,F]=ut(t),q=g.useRef(!1),$=g.useRef(!1),R=g.useRef(a),E=g.useRef(e),L=g.useRef(n),f=()=>L.current,N=()=>f().isVisible()&&f().isOnline(),[v,x,z,I]=Q(r,a),V=g.useRef({}).current,J=d(i)?d(n.fallback)?b:n.fallback[a]:i,et=(w,S)=>{for(const j in V){const C=j;if(C==="data"){if(!u(w[C],S[C])&&(!d(w[C])||!u(ot,S[C])))return!1}else if(S[C]!==w[C])return!1}return!0},D=g.useMemo(()=>{const w=!a||!e?!1:d(m)?f().isPaused()||s?!1:l!==!1:m,S=P=>{const G=tt(P);return delete G._k,w?{isValidating:!0,isLoading:!0,...G}:G},j=v(),C=I(),U=S(j),it=j===C?U:S(C);let A=U;return[()=>{const P=S(v());return et(P,A)?(A.data=P.data,A.isLoading=P.isLoading,A.isValidating=P.isValidating,A.error=P.error,A):(A=P,P)},()=>it]},[r,a]),M=ee.useSyncExternalStore(g.useCallback(w=>z(a,(S,j)=>{et(j,S)||w()}),[r,a]),D[0],D[1]),nt=!q.current,mt=o[a]&&o[a].length>0,X=M.data,T=d(X)?J&&ie(J)?_t(J):J:X,st=M.error,rt=g.useRef(T),ot=h?d(X)?d(rt.current)?T:rt.current:X:T,ft=mt&&!d(st)?!1:nt&&!d(m)?m:f().isPaused()?!1:s?d(T)?!1:l:d(T)||l,qt=!!(a&&e&&nt&&ft),le=d(M.isValidating)?qt:M.isValidating,fe=d(M.isLoading)?qt:M.isLoading,at=g.useCallback(async w=>{const S=E.current;if(!a||!S||$.current||f().isPaused())return!1;let j,C,U=!0;const it=w||{},A=!p[a]||!it.dedupe,P=()=>Xt?!$.current&&a===R.current&&q.current:a===R.current,G={isValidating:!1,isLoading:!1},Ut=()=>{x(G)},Ht=()=>{const W=p[a];W&&W[1]===C&&delete p[a]},kt={isValidating:!0};d(v().data)&&(kt.isLoading=!0);try{if(A&&(x(kt),n.loadingTimeout&&d(v().data)&&setTimeout(()=>{U&&P()&&f().onLoadingSlow(a,n)},n.loadingTimeout),p[a]=[S(F),Pt()]),[j,C]=p[a],j=await j,A&&setTimeout(Ht,n.dedupingInterval),!p[a]||p[a][1]!==C)return A&&P()&&f().onDiscarded(a),!1;G.error=b;const W=y[a];if(!d(W)&&(C<=W[0]||C<=W[1]||W[1]===0))return Ut(),A&&P()&&f().onDiscarded(a),!1;const Y=v().data;G.data=u(Y,j)?Y:j,A&&P()&&f().onSuccess(j,a,n)}catch(W){Ht();const Y=f(),{shouldRetryOnError:Rt}=Y;Y.isPaused()||(G.error=W,A&&P()&&(Y.onError(W,a,Y),(Rt===!0||k(Rt)&&Rt(W))&&(!f().revalidateOnFocus||!f().revalidateOnReconnect||N())&&Y.onErrorRetry(W,a,Y,de=>{const St=o[a];St&&St[0]&&St[0](Gt,de)},{retryCount:(it.retryCount||0)+1,dedupe:!0})))}return U=!1,Ut(),!0},[a,r]),zt=g.useCallback((...w)=>oe(r,R.current,...w),[]);if(Et(()=>{E.current=e,L.current=n,d(X)||(rt.current=X)}),Et(()=>{if(!a)return;const w=at.bind(b,Ct);let S=0;f().revalidateOnFocus&&(S=Date.now()+f().focusThrottleInterval);const C=Be(a,o,(U,it={})=>{if(U==ne){const A=Date.now();f().revalidateOnFocus&&A>S&&N()&&(S=A+f().focusThrottleInterval,w())}else if(U==se)f().revalidateOnReconnect&&N()&&w();else{if(U==re)return at();if(U==Gt)return at(it)}});return $.current=!1,R.current=a,q.current=!0,x({_k:F}),ft&&(d(T)||ct?w():Le(w)),()=>{$.current=!0,C()}},[a]),Et(()=>{let w;function S(){const C=k(_)?_(v().data):_;C&&w!==-1&&(w=setTimeout(j,C))}function j(){!v().error&&(O||f().isVisible())&&(c||f().isOnline())?at(Ct).then(S):S()}return S(),()=>{w&&(clearTimeout(w),w=-1)}},[_,O,c,a]),g.useDebugValue(ot),s&&d(T)&&a){if(!Xt&&ct)throw new Error("Fallback data is required when using Suspense in SSR.");E.current=e,L.current=n,$.current=!1;const w=B[a];if(!d(w)){const S=zt(w);_t(S)}if(d(st)){const S=at(Ct);d(ot)||(S.status="fulfilled",S.value=!0),_t(S)}else throw st}return{mutate:zt,get data(){return V.data=!0,ot},get error(){return V.error=!0,st},get isValidating(){return V.isValidating=!0,le},get isLoading(){return V.isLoading=!0,fe}}},Ge=ke(Ke),Ye=()=>{},Xe=Ye(),Ft=Object,te=t=>t===Xe,Qe=t=>typeof t=="function",pt=new WeakMap,bt=(t,e)=>Ft.prototype.toString.call(t)===`[object ${e}]`;let Ze=0;const Nt=t=>{const e=typeof t,n=bt(t,"Date"),r=bt(t,"RegExp"),u=bt(t,"Object");let s,i;if(Ft(t)===t&&!n&&!r){if(s=pt.get(t),s)return s;if(s=++Ze+"~",pt.set(t,s),Array.isArray(t)){for(s="@",i=0;i<t.length;i++)s+=Nt(t[i])+",";pt.set(t,s)}if(u){s="#";const m=Ft.keys(t).sort();for(;!te(i=m.pop());)te(t[i])||(s+=i+":"+Nt(t[i])+",");pt.set(t,s)}}else s=n?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},tn=t=>{if(Qe(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Nt(t):"",[t,e]},en=t=>tn(t?t(0,null):null)[0],Dt=Promise.resolve(),nn=t=>(e,n,r)=>{const u=g.useRef(!1),{cache:s,initialSize:i=1,revalidateAll:m=!1,persistSize:l=!1,revalidateFirstPage:_=!0,revalidateOnMount:O=!1,parallel:c=!1}=r,[,,,h]=K.get(Wt);let o;try{o=en(e),o&&(o=ae+o)}catch{}const[y,p,B]=Q(s,o),a=g.useCallback(()=>d(y()._l)?i:y()._l,[s,o,i]);ee.useSyncExternalStore(g.useCallback(f=>o?B(o,()=>{f()}):()=>{},[s,o]),a,a);const F=g.useCallback(()=>{const f=y()._l;return d(f)?i:f},[o,i]),q=g.useRef(F());Et(()=>{if(!u.current){u.current=!0;return}o&&p({_l:l?q.current:F()})},[o,s]);const $=O&&!u.current,R=t(o,async f=>{const N=y()._i,v=y()._r;p({_r:b});const x=[],z=F(),[I]=Q(s,f),V=I().data,J=[];let et=null;for(let D=0;D<z;++D){const[M,nt]=ut(e(D,c?null:et));if(!M)break;const[mt,X]=Q(s,M);let T=mt().data;const st=m||N||d(T)||_&&!D&&!d(V)||$||V&&!d(V[D])&&!r.compare(V[D],T);if(n&&(typeof v=="function"?v(T,nt):st)){const rt=async()=>{if(!(M in h))T=await n(nt);else{const ft=h[M];delete h[M],T=await ft}X({data:T,_k:nt}),x[D]=T};c?J.push(rt):await rt()}else x[D]=T;c||(et=T)}return c&&await Promise.all(J.map(D=>D())),p({_i:b}),x},r),E=g.useCallback(function(f,N){const v=typeof N=="boolean"?{revalidate:N}:N||{},x=v.revalidate!==!1;return o?(x&&(d(f)?p({_i:!0,_r:v.revalidate}):p({_i:!1,_r:v.revalidate})),arguments.length?R.mutate(f,{...v,revalidate:x}):R.mutate()):Dt},[o,s]),L=g.useCallback(f=>{if(!o)return Dt;const[,N]=Q(s,o);let v;if(k(f)?v=f(F()):typeof f=="number"&&(v=f),typeof v!="number")return Dt;N({_l:v}),q.current=v;const x=[],[z]=Q(s,o);let I=null;for(let V=0;V<v;++V){const[J]=ut(e(V,I)),[et]=Q(s,J),D=J?et().data:b;if(d(D))return E(z().data);x.push(D),I=D}return E(x)},[o,s,E,F]);return{size:F(),setSize:L,mutate:E,get data(){return R.data},get error(){return R.error},get isValidating(){return R.isValidating},get isLoading(){return R.isLoading}}},sn=Je(Ge,nn),rn=t=>(e,n)=>n&&!n.after?null:e===0?`${t}${t.includes("?")?"&":"?"}limit=25`:`${t}${t.includes("?")?"&":"?"}after=${n==null?void 0:n.after}&limit=25`;function dn(){var q,$,R;const t=pe(),{mode:e,val:n}=t,{isIntersecting:r,ref:u}=Ee({threshold:.9});g.useEffect(()=>{function E(L){L.state&&t.setVal(L.state.val)}return window.addEventListener("popstate",E),()=>{window.removeEventListener("popstate",E)}},[t]);const s=g.useRef(!1),i=(q=me.get(e))==null?void 0:q.url,m=`https://www.reddit.com/${n.startsWith("/")?n.slice(1):n}${i??""}`,{data:l,size:_,setSize:O,error:c,isValidating:h,isLoading:o}=sn(rn(m),async E=>{const L=await fetch(E);if(!L.ok)throw new Error(`HTTP ${L.status} fetching ${E} ${await L.text()}`);return(await L.json()).data}),y=l==null?void 0:l.flatMap(E=>E.children).map(E=>E.data),p=o||_>0&&(l==null?void 0:l[_-1])===void 0,a=((($=l==null?void 0:l[0])==null?void 0:$.children.length)??0)===0||(((R=l==null?void 0:l.at(-1))==null?void 0:R.children.length)??0)<25,F=h&&l&&l.length===_;return g.useEffect(()=>{r&&!s.current&&!o&&!F&&!a&&(s.current=!0,setTimeout(()=>{O(_+1).then(()=>{s.current=!1}).catch(E=>{console.error(E)})},400))},[r,O,_,a,F,o]),H.jsx("div",{children:o?H.jsx("div",{className:"flex justify-center",children:H.jsx(Bt,{})}):c?H.jsx(Se,{error:c}):y?H.jsxs(H.Fragment,{children:[H.jsx(ge,{posts:y}),H.jsx("div",{ref:u,style:{height:400},className:"flex justify-center mt-10",children:p?H.jsx(Bt,{}):a?"End of feed!":H.jsxs("div",{children:["Scroll all the way down or"," ",H.jsx(Re,{onClick:()=>{O(_+1).then(()=>{s.current=!1})},children:"Click here"})," ","to load more"]})})]}):null})}export{dn as default};
//# sourceMappingURL=RedditPostFeed-BkqFmYV8.js.map
