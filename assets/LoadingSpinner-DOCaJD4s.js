const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./AddToFeedDialog-DLTDiOza.js","./index-CePIQKfj.js","./index-DWFJvqPt.css","./BaseDialog-8vpOqQ0n.js","./RedGifsCard-DXCJRQHJ.js","./GalleryCard-DCmYORgl.js","./Sidebar-YrqOXZqj.js","./Link-Be-H5cDg.js","./formatDistanceToNowStrict-B7etE4jS.js","./en-US-DK8Z8mF7.js"])))=>i.map(i=>d[i]);
import{G as Q,j as t,u as x,o as b,r as u,L as D,p as l,q as F,_ as v,M as X,s as Y,B as Z}from"./index-CePIQKfj.js";import{g as N,h as $}from"./Sidebar-YrqOXZqj.js";import{a as W}from"./BaseDialog-8vpOqQ0n.js";import{L as g}from"./Link-Be-H5cDg.js";import{f as q}from"./formatDistanceToNowStrict-B7etE4jS.js";function ee(e){return Q({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 14h4v7a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-7h4a1.001 1.001 0 0 0 .781-1.625l-8-10c-.381-.475-1.181-.475-1.562 0l-8 10A1.001 1.001 0 0 0 4 14z"},child:[]}]})(e)}function ne({error:e}){return t.jsxs("div",{className:"text-red-600 m-20",children:[t.jsx("div",{children:`${e}`}),t.jsxs("div",{children:[`${e}`=="TypeError: NetworkError when attempting to fetch resource."?"If you are on firefox then you can disable 'Enhanced Tracking Protection' (at your own risk) to fix this error":""," "]})]})}const B=(e,n)=>n.some(r=>e instanceof r);let L,M;function te(){return L||(L=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function re(){return M||(M=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const I=new WeakMap,w=new WeakMap,y=new WeakMap;function se(e){const n=new Promise((r,s)=>{const o=()=>{e.removeEventListener("success",d),e.removeEventListener("error",a)},d=()=>{r(h(e.result)),o()},a=()=>{s(e.error),o()};e.addEventListener("success",d),e.addEventListener("error",a)});return y.set(n,e),n}function ie(e){if(I.has(e))return;const n=new Promise((r,s)=>{const o=()=>{e.removeEventListener("complete",d),e.removeEventListener("error",a),e.removeEventListener("abort",a)},d=()=>{r(),o()},a=()=>{s(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",d),e.addEventListener("error",a),e.addEventListener("abort",a)});I.set(e,n)}let C={get(e,n,r){if(e instanceof IDBTransaction){if(n==="done")return I.get(e);if(n==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return h(e[n])},set(e,n,r){return e[n]=r,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function V(e){C=e(C)}function oe(e){return re().includes(e)?function(...n){return e.apply(P(this),n),h(this.request)}:function(...n){return h(e.apply(P(this),n))}}function ae(e){return typeof e=="function"?oe(e):(e instanceof IDBTransaction&&ie(e),B(e,te())?new Proxy(e,C):e)}function h(e){if(e instanceof IDBRequest)return se(e);if(w.has(e))return w.get(e);const n=ae(e);return n!==e&&(w.set(e,n),y.set(n,e)),n}const P=e=>y.get(e);function de(e,n,{blocked:r,upgrade:s,blocking:o,terminated:d}={}){const a=indexedDB.open(e,n),c=h(a);return s&&a.addEventListener("upgradeneeded",i=>{s(h(a.result),i.oldVersion,i.newVersion,h(a.transaction),i)}),r&&a.addEventListener("blocked",i=>r(i.oldVersion,i.newVersion,i)),c.then(i=>{d&&i.addEventListener("close",()=>d()),o&&i.addEventListener("versionchange",f=>o(f.oldVersion,f.newVersion,f))}).catch(()=>{}),c}const ce=["get","getKey","getAll","getAllKeys","count"],le=["put","add","delete","clear"],p=new Map;function O(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(p.get(n))return p.get(n);const r=n.replace(/FromIndex$/,""),s=n!==r,o=le.includes(r);if(!(r in(s?IDBIndex:IDBObjectStore).prototype)||!(o||ce.includes(r)))return;const d=async function(a,...c){const i=this.transaction(a,o?"readwrite":"readonly");let f=i.store;return s&&(f=f.index(c.shift())),(await Promise.all([f[r](...c),o&&i.done]))[0]};return p.set(n,d),d}V(e=>({...e,get:(n,r,s)=>O(n,r)||e.get(n,r,s),has:(n,r)=>!!O(n,r)||e.has(n,r)}));const ue=["continue","continuePrimaryKey","advance"],A={},k=new WeakMap,G=new WeakMap,fe={get(e,n){if(!ue.includes(n))return e[n];let r=A[n];return r||(r=A[n]=function(...s){k.set(this,G.get(this)[n](...s))}),r}};async function*he(...e){let n=this;if(n instanceof IDBCursor||(n=await n.openCursor(...e)),!n)return;n=n;const r=new Proxy(n,fe);for(G.set(r,n),y.set(r,P(n));n;)yield r,n=await(k.get(r)||n.continue()),k.delete(r)}function R(e,n){return n===Symbol.asyncIterator&&B(e,[IDBIndex,IDBObjectStore,IDBCursor])||n==="iterate"&&B(e,[IDBIndex,IDBObjectStore])}V(e=>({...e,get(n,r,s){return R(n,r)?he:e.get(n,r,s)},has(n,r){return R(n,r)||e.has(n,r)}}));const z=de("test",2,{upgrade(e){e.createObjectStore("savedPosts")}}),me=u.lazy(()=>v(()=>import("./AddToFeedDialog-DLTDiOza.js"),__vite__mapDeps([0,1,2,3]),import.meta.url));async function xe(e){await(await z).put("savedPosts",e,e.id)}async function je(e){await(await z).delete("savedPosts",e.id)}function ge({post:e}){var T;const n=x(),{author:r,subreddit:s,subreddit_name_prefixed:o,crosspost_parent_list:d}=e,{val:a}=n,c=((T=d==null?void 0:d[0])==null?void 0:T.subreddit_name_prefixed)??"",i=o,f=b(o,n.favorites),K=b(o,n.favorites),[H,S]=u.useState(!1),[_,j]=u.useState(),[U,E]=u.useState(!1),J=`/u/${r}`;return t.jsxs("div",{children:[_?t.jsx(ne,{error:_}):null,c?t.jsxs(t.Fragment,{children:[t.jsx(D,{to:c,children:t.jsxs(l,{children:["Browse ",c]})}),f?null:t.jsxs(l,{onClick:()=>{n.addFavorite(c)},children:[t.jsx(F,{className:"inline"})," ",c]})]}):null,i===J?null:t.jsxs(t.Fragment,{children:[t.jsx(D,{to:i,children:t.jsxs(l,{children:["Browse ",i]})}),K?null:t.jsxs(l,{onClick:()=>{n.addFavorite(i)},children:[t.jsx(F,{className:"inline"})," ",i]})]}),a==="savedposts"?t.jsxs(l,{onClick:()=>{(async()=>{try{j(void 0),await je(e),n.forceRerender()}catch(m){j(m),console.error(m)}})()},children:[t.jsx(N,{className:"inline"})," Remove from saved"]}):t.jsxs(l,{onClick:()=>{(async()=>{try{j(void 0),await xe(e)}catch(m){j(m),console.error(m)}})(),S(!0),setTimeout(()=>{S(!1)},400)},children:[t.jsx(N,{className:"inline"})," ",H?"Saved!":"Save post"]}),t.jsxs(l,{onClick:()=>{E(!0)},children:[t.jsx(W,{className:"inline"})," Add ",o," to feed"]}),t.jsxs(l,{onClick:()=>{n.setDefaultPage(o)},children:[t.jsx($,{className:"inline"})," Set ",o," as home"]}),U?t.jsx(u.Suspense,{fallback:null,children:t.jsx(me,{subreddit:s,onClose:()=>{E(!1)}})}):null]})}const ve=u.lazy(()=>v(()=>import("./AddToFeedDialog-DLTDiOza.js"),__vite__mapDeps([0,1,2,3]),import.meta.url));function ye({post:e}){const n=x(),{author:r}=e,{favorites:s,blocked:o}=n,[d,a]=u.useState(!1),c=b(`/user/${r}`,s),i=`/u/${r}`;return t.jsxs("div",{children:[t.jsx(D,{to:`/user/${r}`,children:t.jsxs(l,{children:["Browse ",`/u/${r}`]})}),c?null:t.jsxs(l,{onClick:()=>{n.addFavorite(`/user/${r}`)},children:[t.jsx(F,{className:"inline"})," ",i]}),c||o.includes(r)?null:t.jsxs(l,{onClick:()=>{n.setBlocked(r)},children:[t.jsx(X,{className:"inline"})," Block ",i]}),t.jsxs(l,{onClick:()=>{a(!0)},children:[t.jsx(W,{className:"inline"})," Add ",i," to feed"]}),t.jsxs(l,{onClick:()=>{n.setDefaultPage(i)},children:[t.jsx($,{className:"inline"})," Set ",i," as home"]}),d?t.jsx(u.Suspense,{fallback:null,children:t.jsx(ve,{subreddit:`u_${r}`,onClose:()=>{a(!1)}})}):null]})}function we({post:e}){const{subreddit_name_prefixed:n,author:r}=e,s=`u/${r}`;return t.jsxs("div",{children:[t.jsx(ye,{post:e}),s===n?null:t.jsx(ge,{post:e})]})}function pe({post:e}){const{hideButtons:n}=x(),{author:r,subreddit_name_prefixed:s,title:o,permalink:d,url:a}=e;return t.jsxs("div",{children:[t.jsxs("h4",{className:"inline",children:[Y(o)," (",q(new Date(e.created*1e3),{addSuffix:!0}),") [",e.score," ",t.jsx(ee,{className:"inline"}),"]"]})," ","(",t.jsx(g,{href:`https://reddit.com/u/${r}`,target:"_blank",rel:"noreferrer",children:"user"}),") (",t.jsx(g,{href:a,target:"_blank",rel:"noreferrer",children:"url"}),") (",t.jsx(g,{href:`https://reddit.com/${s}`,target:"_blank",rel:"noreferrer",children:"subreddit"}),") (",t.jsx(g,{href:`https://reddit.com${d}`,target:"_blank",rel:"noreferrer",children:"comments"}),")",n?null:t.jsx(we,{post:e})]})}function be({title:e,url:n}){const[r,s]=u.useState(!1);return t.jsx("img",{alt:e,loading:"lazy",onClick:()=>{s(!r)},className:r?"m-auto":"w-full max-h-[80vh] object-contain",src:n})}const De=u.lazy(()=>v(()=>import("./RedGifsCard-DXCJRQHJ.js"),__vite__mapDeps([4,1,2]),import.meta.url)),Fe=u.lazy(()=>v(()=>import("./GalleryCard-DCmYORgl.js"),__vite__mapDeps([5,1,2,6,3,7,8,9]),import.meta.url));function Be(e){return!e.includes("redgifs")&&(e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".webp")||e.endsWith(".png")||e.endsWith(".gif")||e.endsWith(".webp"))}function Ie({post:e}){const{title:n,url:r}=e;return t.jsxs("div",{children:[t.jsx(pe,{post:e}),r.startsWith("https://www.reddit.com/gallery")?t.jsx(Fe,{post:e}):r.includes("redgifs")?t.jsx(De,{post:e}):Be(r)?t.jsx(be,{title:n,url:r}):t.jsxs("div",{children:["We do not know how to embed this post type yet!"," ",t.jsxs("a",{href:r,children:[r," ",n]})]})]})}function Ce({totalFiltered:e}){const n=x(),{redGifsOnly:r}=n;return t.jsxs(t.Fragment,{children:[t.jsx("h1",{children:"Check your filters in the settings or this may just have been a page of comments if you are browsing a user page"}),r?t.jsxs("div",{children:["Note: RedGifs only is on.",t.jsx(Z,{onClick:()=>{n.setRedGifsOnly(!r)},children:"Turn off RedGifs only"})]}):null,t.jsx("div",{children:e?t.jsxs("div",{children:["Total posts filtered out (non-image posts, not matching filters, etc): ",e]}):null}),t.jsx("div",{children:"Note that we are not able to embed v.redd.it videos from e.g. popular SFW reddits"})]})}function Te({posts:e,stats:n}){const{fullscreen:r}=x();return t.jsx("div",{className:"flex justify-center overflow-hidden",children:t.jsx("div",{className:r?"lg:w-11/12":"lg:w-1/2",children:t.jsx("div",{className:"flex flex-col space-y-20",children:e.length>0?e.map(s=>t.jsx(Ie,{post:s},s.id)):n?t.jsx(Ce,{totalPosts:n.totalPosts,commentTypeFiltered:n.commentTypeFiltered,urlTypeFiltered:n.urlTypeFiltered,gifFiltered:n.gifFiltered,redGifsOnlyFiltered:n.redGifsOnlyFiltered,noRedGifsFiltered:n.noRedGifsFiltered,pinnedFiltered:n.pinnedFiltered,blockedFiltered:n.blockedFiltered,remainingPosts:n.remainingPosts,totalFiltered:n.totalPosts-n.remainingPosts}):null})})})}function Ne(){return t.jsx("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",style:{width:100,height:100},viewBox:"0 0 24 24",children:t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})})}export{Te as C,ne as E,be as I,Ne as L,z as d};
//# sourceMappingURL=LoadingSpinner-DOCaJD4s.js.map
